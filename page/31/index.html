
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  
  <title>UMU</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
  <meta property="og:type" content="website">
<meta property="og:title" content="UMU">
<meta property="og:url" content="https://blog.umu618.com/page/31/">
<meta property="og:site_name" content="UMU">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="圣小开">
<meta name="twitter:card" content="summary">
<meta name="twitter:creator" content="@UMU618">
  
  <link rel="alternative" href="/atom.xml" title="UMU" type="application/atom+xml" />
  
  
  <link rel="icon" href="/favicon.ico" />
  
  
<link rel="stylesheet" href="/css/style.css">

  <!--[if lt IE 9]><script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7/html5shiv.min.js"></script><![endif]-->
  
  <script data-ad-client="ca-pub-3156871832516803" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
  var _hmt = _hmt || [];
  (function() {
    var hm = document.createElement("script");
    hm.src = "//hm.baidu.com/hm.js?bfeb40675aeab650834346c3e91557f2";
    var s = document.getElementsByTagName("script")[0]; 
    s.parentNode.insertBefore(hm, s);
  })();
  </script>
<meta name="generator" content="Hexo 5.4.2"></head>
<body>
<div id="container">
  <div id="wrap">
    <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">UMU</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">天地玄黄，宇宙洪荒，度修七鹰劫，证悟神通。</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon" title="菜单"></a>
        
          <a class="main-nav-link" href="/">首页</a>
        
          <a class="main-nav-link" href="/archives">归档</a>
        
          <a class="main-nav-link" href="/about">关于</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS 订阅"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//www.baidu.com/baidu" method="get" accept-charset="utf-8" class="search-form">
          <input type="search" name="word" maxlength="20" class="search-form-input" placeholder="搜索">
          <input type="submit" value="" class="search-form-submit">
          <input name=tn type=hidden value="bds">
          <input name=cl type=hidden value="3">
          <input name=ct type=hidden value="2097152">
          <input type="hidden" name="si" value="blog.umu618.com">
        </form>
      </div>
    </div>
  </div>
</header>
    <div class="outer">
      <section id="main">
  
    <article id="post-umutech-eosio-fix-cluster-writes-for-mongodb" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/12/21/umutech-eosio-fix-cluster-writes-for-mongodb/" class="article-date">
  <time datetime="2018-12-21T13:51:12.000Z" itemprop="datePublished">2018-12-21 21:51:12</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/UMUTech/">UMUTech</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/12/21/umutech-eosio-fix-cluster-writes-for-mongodb/">改进 EOSIO MongoDB 插件对分片集群的插入性能</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>作者: UMU @ MEET.ONE 实验室</p>
</blockquote>
<h2 id="问题">问题</h2>
<p>为了保证 MongoDB 服务器的容量足够应对未来发展，我们做了分片，但经过对比测试，发现每隔 15 分钟左右，nodeos 就会报错，并优雅退出。</p>
<p>查看了社区的 issues 发现有类似情况：<a target="_blank" rel="noopener" href="https://github.com/EOSIO/eos/issues/5488">mongodb shard: line 870, code 61, generic server error</a></p>
<h2 id="解决">解决</h2>
<h3 id="定位代码">定位代码</h3>
<p>反复测试发现，总是同一个地方抛出异常：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// insert action_traces</span></span><br><span class="line"><span class="keyword">if</span>( write_atraces ) &#123;</span><br><span class="line">   <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="keyword">if</span>( !bulk_action_traces.execute() ) &#123;</span><br><span class="line">         EOS_ASSERT( <span class="literal">false</span>, chain::mongo_db_insert_fail,</span><br><span class="line">                     <span class="string">&quot;Bulk action traces insert failed for transaction trace: $&#123;id&#125;&quot;</span>, (<span class="string">&quot;id&quot;</span>, t-&gt;id) );</span><br><span class="line">      &#125;</span><br><span class="line">   &#125; <span class="keyword">catch</span>( ... ) &#123;</span><br><span class="line">      handle_mongo_exception( <span class="string">&quot;action traces insert&quot;</span>, __LINE__ );</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>插入数据的代码很多，但就这个地方报错，说明 action_traces 表有特殊性。</p>
<h3 id="分析异同">分析异同</h3>
<p>action_traces 的 shard key 被定义为 _id，而其他没报错的表并不是 _id。</p>
<h3 id="理论">理论</h3>
<p>批量插入时，_id 是有单调递增性的，根据官方文档<br>
<a target="_blank" rel="noopener" href="https://docs.mongodb.com/master/core/bulk-write-operations/#avoid-monotonic-throttling">Avoid Monotonic Throttling</a>，需要降低单调递增性，才能使批量插入均匀分散到各个 shard 上。</p>
<h3 id="成果">成果</h3>
<p>(<a target="_blank" rel="noopener" href="https://github.com/EOSIO/eos/pull/6498">#6498</a>) Fix cluster writes for mongo DB</p>

      
    </div>
    <footer class="article-footer">
      
        <a data-url="https://blog.umu618.com/2018/12/21/umutech-eosio-fix-cluster-writes-for-mongodb/" data-id="cm3zebrdj011zfk7m4prqa9zc" class="article-share-link" data-share="baidu" data-title="改进 EOSIO MongoDB 插件对分片集群的插入性能">分享到</a>
      

      
        <a href="https://blog.umu618.com/2018/12/21/umutech-eosio-fix-cluster-writes-for-mongodb/#SOHUCS" class="article-comment-link">评论</a>
      

      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/blockchain/" rel="tag">blockchain</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/debug/" rel="tag">debug</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/mongodb/" rel="tag">mongodb</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-umutech-eosio-continuous-rate" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/12/21/umutech-eosio-continuous-rate/" class="article-date">
  <time datetime="2018-12-21T07:32:05.000Z" itemprop="datePublished">2018-12-21 15:32:05</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/UMUTech/">UMUTech</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/12/21/umutech-eosio-continuous-rate/">EOSIO 的连续通胀率 4.879% 是怎么算出来的？</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>作者: UMU @ MEET.ONE 实验室</p>
</blockquote>
<h2 id="问题">问题</h2>
<p>在 <code>eosio.contracts/eosio.system/src/producer_pay.cpp</code> 中有这样一行代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">const double   continuous_rate       &#x3D; 0.04879;          &#x2F;&#x2F; 5% annual rate</span><br></pre></td></tr></table></figure>
<p>搜索一下，会得到这样的解释：</p>
<blockquote>
<p>EOS是连续增发的模式，连续通胀率是 4.879%，年度通胀是 5%；</p>
</blockquote>
<blockquote>
<p>运用微积分的知识，可以推导出来，假设是增发的次数是无限多次，那么，连续通胀的情景下，所设置的连续通胀率就是 4.879%。</p>
</blockquote>
<p>然而，并没有解释具体算法……</p>
<h2 id="求解">求解</h2>
<ul>
<li>假设通胀率是“每日结算”的，记为 daily_rate，则：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(1 + daily_rate &#x2F; 365) ^ 365 &#x3D; 1 + annual_rate</span><br><span class="line"></span><br><span class="line">注：这里的 ^ 表示幂，不是 XOR 运算。</span><br></pre></td></tr></table></figure>
<p>那么计算 daily_rate 的公式为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[365TH_ROOT(1 + annual_rate) - 1] * 365</span><br><span class="line"></span><br><span class="line">注：365TH_ROOT 是开 365 次方</span><br></pre></td></tr></table></figure>
<p>把 5% 带入，计算结果是：<code>0.048793425246406</code>，这个数值已经和 0.04879 基本一样了。</p>
<ul>
<li>但是“每日结算”并不够，接下来推到时时刻刻都在结算的情况。</li>
</ul>
<p>问题本质：已知 annual_rate、<code>(1 + continuous_rate / N) ^ N = 1 + annual_rate</code>，求 continuous_rate 在 N 为无穷大时的解。</p>
<p>复习一下大学数学，马上就会发现 <code>lim N-&gt;∞ (1 + x / N) ^ N</code> 就是 <code>e ^ x</code> 的定义，所以：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">continuous_rate &#x3D; ln(1 + annual_rate)</span><br></pre></td></tr></table></figure>
<p>把 5% 代入 annual_rate，<code>continuous_rate = 0.048790164169432</code></p>
<h2 id="参考">参考</h2>
<p>#1537 <a target="_blank" rel="noopener" href="https://github.com/EOSIO/eos/issues/1537">DAWN-651 ⁃ setting correct per-block “continuous inflation” so annual inflation is 5%</a></p>

      
    </div>
    <footer class="article-footer">
      
        <a data-url="https://blog.umu618.com/2018/12/21/umutech-eosio-continuous-rate/" data-id="cm3zebrdj011wfk7m49p3c9n5" class="article-share-link" data-share="baidu" data-title="EOSIO 的连续通胀率 4.879% 是怎么算出来的？">分享到</a>
      

      
        <a href="https://blog.umu618.com/2018/12/21/umutech-eosio-continuous-rate/#SOHUCS" class="article-comment-link">评论</a>
      

      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/blockchain/" rel="tag">blockchain</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E8%B0%83%E7%A0%94/" rel="tag">调研</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E9%87%91%E8%9E%8D/" rel="tag">金融</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-umutech-using-mongodb-4-with-eosio-1-5-mongodb-plugin" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/12/16/umutech-using-mongodb-4-with-eosio-1-5-mongodb-plugin/" class="article-date">
  <time datetime="2018-12-16T15:04:42.000Z" itemprop="datePublished">2018-12-16 23:04:42</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/UMUTech/">UMUTech</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/12/16/umutech-using-mongodb-4-with-eosio-1-5-mongodb-plugin/">EOSIO 1.5.0 MongoDB 插件搭配 MongoDB 4.0.4</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="问题描述">问题描述</h2>
<p>在前文《<a href="/2018/12/11/umutech-mongodb-on-centos/">为 EOSIO MongoDB 插件搭建高可用集群</a>》中，我们使用了 MongoDB 4.0.4，如果直接配套 EOSIO 1.5 版本，MongoDB 插件用的 MongoDB C Driver 与 MongoDB 4.0.4 是不完全兼容的。</p>
<ul>
<li>
<p>EOSIO 1.5 指定的 MongoDB 版本是 3.6.3；</p>
</li>
<li>
<p>MongoDB 4.0 的客户端需要 MongoDB C Driver 1.11.0，而 EOSIO 1.5 用的是 1.10.2。</p>
</li>
</ul>
<blockquote>
<p>参考：<a target="_blank" rel="noopener" href="https://docs.mongodb.com/manual/release-notes/4.0/#drivers">Release Notes for MongoDB 4.0</a></p>
</blockquote>
<h2 id="改进方案">改进方案</h2>
<p>修改 <code>eos/scripts/eosio_build_$&#123;SYS_NAME&#125;.sh</code>，其中 SYS_NAME 是系统名字，以 macOS 为例，应该改的是 <code>eos/scripts/eosio_build_darwin.sh</code>。</p>
<ul>
<li>
<p>把 mongo-c-driver 版本改到足够高，比如 1.13.0，即把脚本里的下载链接 <code>https://github.com/mongodb/mongo-c-driver/releases/download/1.10.2/mongo-c-driver-1.10.2.tar.gz</code> 改为 <code>https://github.com/mongodb/mongo-c-driver/releases/download/1.13.0/mongo-c-driver-1.13.0.tar.gz</code></p>
</li>
<li>
<p>把 mongo-cxx-driver 版本改到足够高，比如 3.4.0，可以直接把脚本里的 <code>git clone https://github.com/mongodb/mongo-cxx-driver.git --branch releases/v3.3 --depth 1</code> 改为 <code>git clone https://github.com/mongodb/mongo-cxx-driver.git --branch releases/stable --depth 1</code></p>
</li>
<li>
<p>Ubuntu 操作参考：</p>
</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">sed -i <span class="string">&#x27;s/releases\/v3.3/releases\/stable/;s/1\.10\.2/1\.13\.0/g&#x27;</span> scripts/eosio_build_ubuntu.sh</span><br><span class="line"></span><br><span class="line"><span class="comment"># 编译前</span></span><br><span class="line">grep <span class="string">&quot;Version:&quot;</span> /usr/<span class="built_in">local</span>/lib/pkgconfig/libmongocxx-static.pc</span><br><span class="line">Version: 3.3.2-pre</span><br><span class="line"></span><br><span class="line"><span class="comment"># 编译</span></span><br><span class="line">./eosio_build.sh</span><br><span class="line"></span><br><span class="line"><span class="comment"># 编译后</span></span><br><span class="line">grep <span class="string">&quot;Version:&quot;</span> /usr/<span class="built_in">local</span>/lib/pkgconfig/libmongocxx-static.pc</span><br><span class="line">Version: 3.4.0</span><br></pre></td></tr></table></figure>
<p>然后编译、安装 eos。</p>
<blockquote>
<p>参考：</p>
<p><a target="_blank" rel="noopener" href="https://github.com/mongodb/mongo-c-driver/releases/tag/1.13.0">mongo-c-driver 1.13.0</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/mongodb/mongo-cxx-driver/releases/tag/r3.4.0">MongoDB C++11 Driver 3.4.0</a></p>
</blockquote>
<h2 id="注意事项">注意事项</h2>
<p>以上方法不适用于 v1.7.0，新版 eos 已经使用新版 mongo-c-driver 和 MongoDB C++11 Driver，唯一需要改的是 <code>eos/scripts/eosio_build.sh</code> 的这行：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> MONGODB_VERSION=4.0.6 <span class="comment">#3.6.3</span></span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      
        <a data-url="https://blog.umu618.com/2018/12/16/umutech-using-mongodb-4-with-eosio-1-5-mongodb-plugin/" data-id="cm3zebrdi011tfk7mai3r021w" class="article-share-link" data-share="baidu" data-title="EOSIO 1.5.0 MongoDB 插件搭配 MongoDB 4.0.4">分享到</a>
      

      
        <a href="https://blog.umu618.com/2018/12/16/umutech-using-mongodb-4-with-eosio-1-5-mongodb-plugin/#SOHUCS" class="article-comment-link">评论</a>
      

      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/blockchain/" rel="tag">blockchain</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/debug/" rel="tag">debug</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/linux/" rel="tag">linux</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/mongodb/" rel="tag">mongodb</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-umutech-mongodb-on-centos" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/12/11/umutech-mongodb-on-centos/" class="article-date">
  <time datetime="2018-12-11T04:04:28.000Z" itemprop="datePublished">2018-12-11 12:04:28</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/UMUTech/">UMUTech</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/12/11/umutech-mongodb-on-centos/">为 EOSIO MongoDB 插件搭建高可用集群</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="选型">选型</h2>
<p><strong>系统：CentOS7。</strong> 正像大部分国人喜欢用免费的 Windows 旗舰版，采用 RedHat 社区版，既有“企业级待遇”，又免费。实在是解决选择恐惧症必备良药……</p>
<p><strong>MongoDB：4.0.4。</strong> 4.0 之前的版本不支持一些类型转换的函数，后期使用起来很麻烦。举个例子：</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://docs.mongodb.com/manual/reference/operator/aggregation/toDate/#exp._S_toDate">$toDate</a></p>
<p>New in version 4.0.</p>
</blockquote>
<p><strong>文件系统：XFS。</strong> 4.0 已经抛弃 <a target="_blank" rel="noopener" href="https://docs.mongodb.com/manual/core/mmapv1/#storage-mmapv1">MMAPv1 Storage Engine</a>，官方文档强烈建议 <a target="_blank" rel="noopener" href="https://docs.mongodb.com/manual/core/wiredtiger/#storage-wiredtiger"><br>
WiredTiger Storage Engine</a> 和 XFS 配套使用。</p>
<blockquote>
<p>With the WiredTiger storage engine, using XFS is strongly recommended for data bearing nodes to avoid performance issues that may occur when using EXT4 with WiredTiger.</p>
</blockquote>
<p><strong>副本数：1。</strong> 数据可以很容易重新获取，丢失的代价不高，所以副本不是很重要（有钱请搞三副本）。另外，目前 nodeos 较常把数据弄脏，在它本身没高可用时，不宜对数据库投入太多成本。</p>
<p><strong>机器配置：某云服务器一台。</strong> 16 Cores，256G RAM，启动盘 10G，额外八个 1T Disk。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">$ lsblk</span><br><span class="line">NAME   MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT</span><br><span class="line">sda      8:0    0   10G  0 disk </span><br><span class="line">└─sda1   8:1    0   10G  0 part /</span><br><span class="line">sdb      8:16   0    1T  0 disk </span><br><span class="line">sdc      8:32   0    1T  0 disk </span><br><span class="line">sdd      8:48   0    1T  0 disk </span><br><span class="line">sde      8:64   0    1T  0 disk </span><br><span class="line">sdf      8:80   0    1T  0 disk </span><br><span class="line">sdg      8:96   0    1T  0 disk </span><br><span class="line">sdh      8:112  0    1T  0 disk </span><br><span class="line">sdi      8:128  0    1T  0 disk </span><br></pre></td></tr></table></figure>
<h2 id="环境配置">环境配置</h2>
<h3 id="1-设置-SE-Linux">1. 设置 SE Linux</h3>
<p>安装过程中，若您需要 reboot 系统，则每次 reboot 之后都要做一次：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">setenforce Permissive</span><br></pre></td></tr></table></figure>
<h3 id="2-关闭-TPH">2. 关闭 TPH</h3>
<p>以下命令不是持久化改变，但比较容易说明改了啥，仅供参考：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> never &gt; /sys/kernel/mm/transparent_hugepage/enabled</span><br><span class="line"><span class="built_in">echo</span> never &gt; /sys/kernel/mm/transparent_hugepage/defrag</span><br></pre></td></tr></table></figure>
<p>根据 <a target="_blank" rel="noopener" href="https://docs.mongodb.com/manual/tutorial/transparent-huge-pages/index.html#red-hat-centos-7">Disable Transparent Huge Pages (THP)</a>，真正使用的是：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p /etc/tuned/no-thp</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;[main]</span></span><br><span class="line"><span class="string">include=virtual-guest</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[vm]</span></span><br><span class="line"><span class="string">transparent_hugepages=never&#x27;</span> &gt; /etc/tuned/no-thp/tuned.conf</span><br><span class="line"></span><br><span class="line">tuned-adm profile no-thp</span><br></pre></td></tr></table></figure>
<h3 id="3-TCP-优化">3. TCP 优化</h3>
<p>以下命令不是持久化改变，但比较容易说明优化了啥，仅供参考：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> 120 &gt; /proc/sys/net/ipv4/tcp_keepalive_time</span><br><span class="line"><span class="built_in">echo</span> 3 &gt; /proc/sys/net/ipv4/tcp_fin_timeout</span><br><span class="line"><span class="built_in">echo</span> 3 &gt; /proc/sys/net/ipv4/tcp_orphan_retries</span><br></pre></td></tr></table></figure>
<p>真正使用的是：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">FILE=/etc/sysctl.conf</span><br><span class="line">cp <span class="variable">$FILE</span> <span class="variable">$&#123;FILE&#125;</span>_`date +%Y%m%d%H%M`</span><br><span class="line"></span><br><span class="line">KEY=tcp_keepalive_time</span><br><span class="line">VALUE=120</span><br><span class="line"></span><br><span class="line">egrep <span class="string">&quot;net.ipv4.<span class="variable">$KEY</span>&quot;</span> <span class="variable">$FILE</span> &amp;&amp; sed -i -c <span class="string">&quot;s/net\.ipv4\.<span class="variable">$KEY</span>.*/net\.ipv4\.<span class="variable">$KEY</span> = <span class="variable">$VALUE</span>/g&quot;</span> <span class="variable">$FILE</span> || <span class="built_in">echo</span> <span class="string">&quot;net.ipv4.<span class="variable">$KEY</span> = <span class="variable">$VALUE</span>&quot;</span> &gt;&gt; <span class="variable">$FILE</span></span><br><span class="line"></span><br><span class="line">VALUE=3</span><br><span class="line">KEY=tcp_fin_timeout</span><br><span class="line"></span><br><span class="line">egrep <span class="string">&quot;net.ipv4.<span class="variable">$KEY</span>&quot;</span> <span class="variable">$FILE</span> &amp;&amp; sed -i -c <span class="string">&quot;s/net\.ipv4\.<span class="variable">$KEY</span>.*/net\.ipv4\.<span class="variable">$KEY</span> = <span class="variable">$VALUE</span>/g&quot;</span> <span class="variable">$FILE</span> || <span class="built_in">echo</span> <span class="string">&quot;net.ipv4.<span class="variable">$KEY</span> = <span class="variable">$VALUE</span>&quot;</span> &gt;&gt; <span class="variable">$FILE</span></span><br><span class="line"></span><br><span class="line">KEY=tcp_orphan_retries</span><br><span class="line"></span><br><span class="line">egrep <span class="string">&quot;net.ipv4.<span class="variable">$KEY</span>&quot;</span> <span class="variable">$FILE</span> &amp;&amp; sed -i -c <span class="string">&quot;s/net\.ipv4\.<span class="variable">$KEY</span>.*/net\.ipv4\.<span class="variable">$KEY</span> = <span class="variable">$VALUE</span>/g&quot;</span> <span class="variable">$FILE</span> || <span class="built_in">echo</span> <span class="string">&quot;net.ipv4.<span class="variable">$KEY</span> = <span class="variable">$VALUE</span>&quot;</span> &gt;&gt; <span class="variable">$FILE</span></span><br><span class="line"></span><br><span class="line">sysctl -p 2&gt;/tmp/sysctl.tmp</span><br></pre></td></tr></table></figure>
<h2 id="安装步骤">安装步骤</h2>
<h3 id="1-全局设置">1. 全局设置</h3>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">PASSWORD=MEETONE_FAKE_PASSWORD</span><br><span class="line"></span><br><span class="line">PREFIX=/disk</span><br><span class="line">BIND_IP=10.140.0.10</span><br><span class="line">D_PORT=17089</span><br><span class="line">CS_PORT=17088</span><br><span class="line">S_PORT=17087</span><br><span class="line">NUM_SHARD=7</span><br></pre></td></tr></table></figure>
<h3 id="2-防火墙例外">2. 防火墙例外</h3>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">semanage port -a -t mongod_port_t -p tcp 17087-17095</span><br></pre></td></tr></table></figure>
<h3 id="3-分区">3. 分区</h3>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">yum install -y xfsprogs</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> InitDisk &#123;</span><br><span class="line">  umount <span class="variable">$&#123;PREFIX&#125;</span>*</span><br><span class="line">  sed -i <span class="string">&quot;s:^LABEL=<span class="variable">$&#123;PREFIX&#125;</span>:#LABEL=<span class="variable">$&#123;PREFIX&#125;</span>:&quot;</span> /etc/fstab</span><br><span class="line">  i=0</span><br><span class="line">  <span class="keyword">for</span> drv <span class="keyword">in</span> &#123;b..i&#125;; <span class="keyword">do</span></span><br><span class="line">    /sbin/parted /dev/sd<span class="string">&quot;<span class="variable">$drv</span>&quot;</span> -s mklabel gpt mkpart primary 2048s 100%</span><br><span class="line">    sleep 1</span><br><span class="line">    mkfs.xfs -f -b size=4096 -d su=64k,sw=4,agcount=2000 /dev/sd<span class="string">&quot;<span class="variable">$drv</span>&quot;</span>1</span><br><span class="line">    xfs_admin -L <span class="variable">$&#123;PREFIX&#125;</span><span class="variable">$i</span> /dev/sd<span class="string">&quot;<span class="variable">$drv</span>&quot;</span>1</span><br><span class="line">    mkdir -p <span class="variable">$&#123;PREFIX&#125;</span><span class="variable">$i</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;LABEL=<span class="variable">$&#123;PREFIX&#125;</span><span class="variable">$i</span> <span class="variable">$&#123;PREFIX&#125;</span><span class="variable">$i</span> xfs rw,noatime,nodiratime,allocsize=16M,inode64,logbsize=256k,delaylog,nobarrier,nolargeio,swalloc 0 0&quot;</span> &gt;&gt; /etc/fstab</span><br><span class="line"></span><br><span class="line">    i=$[i+1]</span><br><span class="line">  <span class="keyword">done</span></span><br><span class="line">  mount -a</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">InitDisk</span><br></pre></td></tr></table></figure>
<h3 id="4-安装-MongoDB-Community-Edition">4. 安装 MongoDB Community Edition</h3>
<p>参考官网的安装文档：<a target="_blank" rel="noopener" href="https://docs.mongodb.com/manual/tutorial/install-mongodb-on-red-hat/">Install MongoDB Community Edition on Red Hat Enterprise or CentOS Linux</a></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;[mongodb-org-4.0]</span></span><br><span class="line"><span class="string">name=MongoDB Repository</span></span><br><span class="line"><span class="string">baseurl=https://repo.mongodb.org/yum/redhat/$releasever/mongodb-org/4.0/x86_64/</span></span><br><span class="line"><span class="string">gpgcheck=1</span></span><br><span class="line"><span class="string">enabled=1</span></span><br><span class="line"><span class="string">gpgkey=https://www.mongodb.org/static/pgp/server-4.0.asc&#x27;</span> &gt; /etc/yum.repos.d/mongodb-org-4.0.repo</span><br><span class="line"></span><br><span class="line">yum install -y mongodb-org</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;exclude=mongodb-org,mongodb-org-server,mongodb-org-shell,mongodb-org-mongos,mongodb-org-tools&#x27;</span> &gt;&gt; /etc/yum.conf</span><br></pre></td></tr></table></figure>
<h3 id="5-初始化数据库目录">5. 初始化数据库目录</h3>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> InitDir &#123;</span><br><span class="line">  rm -rf <span class="variable">$&#123;PREFIX&#125;</span>0/mongod_conf_data <span class="variable">$&#123;PREFIX&#125;</span>0/mongo_log</span><br><span class="line">  <span class="keyword">for</span> ((i = 1; i &lt;= <span class="variable">$NUM_SHARD</span>; ++i)); <span class="keyword">do</span></span><br><span class="line">    rm -rf <span class="variable">$&#123;PREFIX&#125;</span><span class="variable">$i</span>/mongo*</span><br><span class="line">  <span class="keyword">done</span></span><br><span class="line"></span><br><span class="line">  mkdir -p <span class="variable">$&#123;PREFIX&#125;</span>0/mongod_conf_data</span><br><span class="line">  chown -R mongod. <span class="variable">$&#123;PREFIX&#125;</span>0/mongod_conf_data</span><br><span class="line">  mkdir -p <span class="variable">$&#123;PREFIX&#125;</span>0/mongo_log</span><br><span class="line">  chown -R mongod. <span class="variable">$&#123;PREFIX&#125;</span>0/mongo_log</span><br><span class="line">  <span class="keyword">for</span> ((i = 1; i &lt;= <span class="variable">$NUM_SHARD</span>; ++i)); <span class="keyword">do</span></span><br><span class="line">    mkdir -p <span class="variable">$&#123;PREFIX&#125;</span><span class="variable">$i</span>/mongod_data</span><br><span class="line">    chown mongod. <span class="variable">$&#123;PREFIX&#125;</span><span class="variable">$i</span>/mongo*</span><br><span class="line">  <span class="keyword">done</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">InitDir</span><br></pre></td></tr></table></figure>
<h3 id="6-配置-MongoD-分片服务器">6. 配置 MongoD 分片服务器</h3>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> CreateShardConfig &#123;</span><br><span class="line">  <span class="keyword">for</span> ((i = 1; i &lt;= <span class="variable">$NUM_SHARD</span>; ++i)); <span class="keyword">do</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;shardsvr=true</span></span><br><span class="line"><span class="string">replSet=shard<span class="variable">$i</span></span></span><br><span class="line"><span class="string">bind_ip=127.0.0.1,<span class="variable">$BIND_IP</span></span></span><br><span class="line"><span class="string">port=$[D_PORT+i-1]</span></span><br><span class="line"><span class="string">dbpath=<span class="variable">$&#123;PREFIX&#125;</span><span class="variable">$i</span>/mongod_data</span></span><br><span class="line"><span class="string">logpath=<span class="variable">$&#123;PREFIX&#125;</span>0/mongo_log/shard<span class="variable">$i</span>.log</span></span><br><span class="line"><span class="string">pidfilepath=/var/run/mongodb/mongod_shard<span class="variable">$i</span>.pid</span></span><br><span class="line"><span class="string">logappend=true</span></span><br><span class="line"><span class="string">logRotate=reopen</span></span><br><span class="line"><span class="string">fork=true</span></span><br><span class="line"><span class="string">wiredTigerCacheSizeGB=10</span></span><br><span class="line"><span class="string">#keyFile=/etc/mongodb-keyfile</span></span><br><span class="line"><span class="string">#verbose=true</span></span><br><span class="line"><span class="string">directoryperdb=true</span></span><br><span class="line"><span class="string">wiredTigerDirectoryForIndexes=true&quot;</span> &gt; /etc/mongod_shard<span class="variable">$i</span>.conf</span><br><span class="line">    chown mongod. /etc/mongod_shard<span class="variable">$i</span>.conf</span><br><span class="line">  <span class="keyword">done</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> CreateShardService &#123;</span><br><span class="line">  <span class="keyword">for</span> ((i = 1; i &lt;= <span class="variable">$NUM_SHARD</span>; ++i)); <span class="keyword">do</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;[Unit]</span></span><br><span class="line"><span class="string">Description=MongoD</span></span><br><span class="line"><span class="string">After=network.target</span></span><br><span class="line"><span class="string">Documentation=https://docs.mongodb.org/manual</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[Service]</span></span><br><span class="line"><span class="string">User=mongod</span></span><br><span class="line"><span class="string">Group=mongod</span></span><br><span class="line"><span class="string">Environment=\&quot;OPTIONS=-f /etc/mongod_shard<span class="variable">$i</span>.conf\&quot;</span></span><br><span class="line"><span class="string">EnvironmentFile=-/etc/sysconfig/mongod</span></span><br><span class="line"><span class="string">ExecStart=/usr/bin/mongod \$OPTIONS</span></span><br><span class="line"><span class="string">ExecStartPre=/usr/bin/mkdir -p /var/run/mongodb</span></span><br><span class="line"><span class="string">ExecStartPre=/usr/bin/chown mongod:mongod /var/run/mongodb</span></span><br><span class="line"><span class="string">ExecStartPre=/usr/bin/chmod 0755 /var/run/mongodb</span></span><br><span class="line"><span class="string">PermissionsStartOnly=true</span></span><br><span class="line"><span class="string">PIDFile=/var/run/mongodb/mongod_shard<span class="variable">$i</span>.pid</span></span><br><span class="line"><span class="string">Type=forking</span></span><br><span class="line"><span class="string"># file size</span></span><br><span class="line"><span class="string">LimitFSIZE=infinity</span></span><br><span class="line"><span class="string"># cpu time</span></span><br><span class="line"><span class="string">LimitCPU=infinity</span></span><br><span class="line"><span class="string"># virtual memory size</span></span><br><span class="line"><span class="string">LimitAS=infinity</span></span><br><span class="line"><span class="string"># open files</span></span><br><span class="line"><span class="string">LimitNOFILE=64000</span></span><br><span class="line"><span class="string"># processes/threads</span></span><br><span class="line"><span class="string">LimitNPROC=64000</span></span><br><span class="line"><span class="string"># locked memory</span></span><br><span class="line"><span class="string">LimitMEMLOCK=infinity</span></span><br><span class="line"><span class="string"># total threads (user+kernel)</span></span><br><span class="line"><span class="string">TasksMax=infinity</span></span><br><span class="line"><span class="string">TasksAccounting=false</span></span><br><span class="line"><span class="string"># Recommended limits for mongod as specified in</span></span><br><span class="line"><span class="string"># http://docs.mongodb.org/manual/reference/ulimit/#recommended-settings</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[Install]</span></span><br><span class="line"><span class="string">WantedBy=multi-user.target&quot;</span> &gt; /usr/lib/systemd/system/mongod_shard<span class="variable">$i</span>.service</span><br><span class="line">  <span class="keyword">done</span></span><br><span class="line"></span><br><span class="line">  systemctl daemon-reload</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> InitShard &#123;</span><br><span class="line">  SH=/tmp/mongod_shard.sh</span><br><span class="line">  <span class="built_in">echo</span> <span class="string">&quot;&quot;</span> &gt; <span class="variable">$FILE</span></span><br><span class="line">  <span class="keyword">for</span> ((i = 1; i &lt;= <span class="variable">$NUM_SHARD</span>; ++i)); <span class="keyword">do</span></span><br><span class="line">    PORT=$[D_PORT+i-1]</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;echo \&quot;rs.initiate(&#123;_id: &#x27;shard<span class="variable">$i</span>&#x27;, members:[&#123;_id: 0, host: &#x27;<span class="variable">$BIND_IP</span>:<span class="variable">$PORT</span>&#x27;&#125;]&#125;)\&quot; | mongo --host 127.0.0.1 --port <span class="variable">$PORT</span>&quot;</span> &gt;&gt; <span class="variable">$SH</span></span><br><span class="line">  <span class="keyword">done</span></span><br><span class="line">  bash <span class="variable">$SH</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> CreateShardUser &#123;</span><br><span class="line">  JS=/tmp/mongod_shard.js</span><br><span class="line"></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">&quot;use admin;</span></span><br><span class="line"><span class="string">db.createUser(&#123; \&quot;user\&quot;: \&quot;MongoAdmin\&quot;, \&quot;pwd\&quot;: \&quot;<span class="variable">$&#123;PASSWORD&#125;</span>\&quot;, \&quot;roles\&quot;: [\&quot;root\&quot;]&#125;);</span></span><br><span class="line"><span class="string">cfg = rs.conf();</span></span><br><span class="line"><span class="string">cfg.members[0].priority = 10;</span></span><br><span class="line"><span class="string">rs.reconfig(cfg);&quot;</span> &gt; <span class="variable">$JS</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> ((i = 1; i &lt;= <span class="variable">$NUM_SHARD</span>; ++i)); <span class="keyword">do</span></span><br><span class="line">    mongo --port $[CS_PORT+i-1] &lt; <span class="variable">$JS</span></span><br><span class="line">  <span class="keyword">done</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">CreateShardConfig</span><br><span class="line">CreateShardService</span><br><span class="line"><span class="keyword">for</span> ((i = 1; i &lt;= <span class="variable">$NUM_SHARD</span>; ++i)); <span class="keyword">do</span> systemctl restart mongod_shard<span class="variable">$i</span>.service; <span class="keyword">done</span></span><br><span class="line">InitShard</span><br><span class="line">CreateShardUser</span><br></pre></td></tr></table></figure>
<h3 id="7-配置-MongDB-Config-Server">7. 配置 MongDB Config Server</h3>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> CreateConfigServerConfig &#123;</span><br><span class="line">  FILE=/etc/mongod.conf</span><br><span class="line"></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">&quot;replSet=csReplSet</span></span><br><span class="line"><span class="string">configsvr=true</span></span><br><span class="line"><span class="string">bind_ip=127.0.0.1,<span class="variable">$BIND_IP</span></span></span><br><span class="line"><span class="string">port=<span class="variable">$CS_PORT</span></span></span><br><span class="line"><span class="string">dbpath=<span class="variable">$&#123;PREFIX&#125;</span>0/mongod_conf_data</span></span><br><span class="line"><span class="string">logpath=<span class="variable">$&#123;PREFIX&#125;</span>0/mongo_log/config.log</span></span><br><span class="line"><span class="string">pidfilepath=/var/run/mongodb/mongod.pid</span></span><br><span class="line"><span class="string">logappend=true</span></span><br><span class="line"><span class="string">logRotate=reopen</span></span><br><span class="line"><span class="string">fork=true</span></span><br><span class="line"><span class="string">#keyFile=/etc/mongodb-keyfile&quot;</span> &gt; <span class="variable">$FILE</span></span><br><span class="line"></span><br><span class="line">  chown mongod. <span class="variable">$FILE</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> CreateConfigServerService &#123;</span><br><span class="line">  <span class="built_in">echo</span> <span class="string">&#x27;[Unit]</span></span><br><span class="line"><span class="string">Description=MongoCS</span></span><br><span class="line"><span class="string">After=network.target</span></span><br><span class="line"><span class="string">Documentation=https://docs.mongodb.org/manual</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[Service]</span></span><br><span class="line"><span class="string">User=mongod</span></span><br><span class="line"><span class="string">Group=mongod</span></span><br><span class="line"><span class="string">Environment=&quot;OPTIONS=-f /etc/mongod.conf&quot;</span></span><br><span class="line"><span class="string">EnvironmentFile=-/etc/sysconfig/mongod</span></span><br><span class="line"><span class="string">ExecStart=/usr/bin/mongod $OPTIONS</span></span><br><span class="line"><span class="string">ExecStartPre=/usr/bin/mkdir -p /var/run/mongodb</span></span><br><span class="line"><span class="string">ExecStartPre=/usr/bin/chown mongod:mongod /var/run/mongodb</span></span><br><span class="line"><span class="string">ExecStartPre=/usr/bin/chmod 0755 /var/run/mongodb</span></span><br><span class="line"><span class="string">PermissionsStartOnly=true</span></span><br><span class="line"><span class="string">PIDFile=/var/run/mongodb/mongod.pid</span></span><br><span class="line"><span class="string">Type=forking</span></span><br><span class="line"><span class="string"># file size</span></span><br><span class="line"><span class="string">LimitFSIZE=infinity</span></span><br><span class="line"><span class="string"># cpu time</span></span><br><span class="line"><span class="string">LimitCPU=infinity</span></span><br><span class="line"><span class="string"># virtual memory size</span></span><br><span class="line"><span class="string">LimitAS=infinity</span></span><br><span class="line"><span class="string"># open files</span></span><br><span class="line"><span class="string">LimitNOFILE=64000</span></span><br><span class="line"><span class="string"># processes/threads</span></span><br><span class="line"><span class="string">LimitNPROC=64000</span></span><br><span class="line"><span class="string"># locked memory</span></span><br><span class="line"><span class="string">LimitMEMLOCK=infinity</span></span><br><span class="line"><span class="string"># total threads (user+kernel)</span></span><br><span class="line"><span class="string">TasksMax=infinity</span></span><br><span class="line"><span class="string">TasksAccounting=false</span></span><br><span class="line"><span class="string"># Recommended limits for mongod as specified in</span></span><br><span class="line"><span class="string"># http://docs.mongodb.org/manual/reference/ulimit/#recommended-settings</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[Install]</span></span><br><span class="line"><span class="string">WantedBy=multi-user.target&#x27;</span> &gt; /usr/lib/systemd/system/mongod.service</span><br><span class="line"></span><br><span class="line">  systemctl daemon-reload</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">CreateConfigServerConfig</span><br><span class="line">CreateConfigServerService</span><br><span class="line"></span><br><span class="line">systemctl restart mongod.service</span><br><span class="line"></span><br><span class="line">sleep 5</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;rs.initiate(&#123;_id: &#x27;csReplSet&#x27;, members:[&#123;_id: 0, host: &#x27;<span class="variable">$BIND_IP</span>:<span class="variable">$CS_PORT</span>&#x27;&#125;]&#125;)&quot;</span> | mongo --port <span class="variable">$CS_PORT</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;use admin;</span></span><br><span class="line"><span class="string">db.createUser(&#123; \&quot;user\&quot;: \&quot;MongoAdmin\&quot;, \&quot;pwd\&quot;: \&quot;<span class="variable">$&#123;PASSWORD&#125;</span>\&quot;, \&quot;roles\&quot;: [\&quot;root\&quot;]&#125;);&quot;</span> | mongo --port <span class="variable">$CS_PORT</span></span><br></pre></td></tr></table></figure>
<h3 id="8-配置-MongS">8. 配置 MongS</h3>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> CreateMongoSConfig &#123;</span><br><span class="line">  FILE=/etc/mongos.conf</span><br><span class="line"></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">&quot;configdb=csReplSet/<span class="variable">$BIND_IP</span>:<span class="variable">$CS_PORT</span></span></span><br><span class="line"><span class="string">bind_ip_all=true</span></span><br><span class="line"><span class="string">port=17087</span></span><br><span class="line"><span class="string">logpath=<span class="variable">$&#123;PREFIX&#125;</span>0/mongos_log/mongos.log</span></span><br><span class="line"><span class="string">pidfilepath=/var/run/mongodb/mongos.pid</span></span><br><span class="line"><span class="string">logappend=true</span></span><br><span class="line"><span class="string">logRotate=reopen</span></span><br><span class="line"><span class="string">fork=true</span></span><br><span class="line"><span class="string">#keyFile=/etc/mongodb-keyfile&quot;</span> &gt; <span class="variable">$FILE</span></span><br><span class="line"></span><br><span class="line">  chown mongod. <span class="variable">$FILE</span></span><br><span class="line"></span><br><span class="line">  mkdir -p <span class="variable">$&#123;PREFIX&#125;</span>0/mongos_log</span><br><span class="line">  chown -R mongod. <span class="variable">$&#123;PREFIX&#125;</span>0/mongos_log</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> CreateMongoSService &#123;</span><br><span class="line">  <span class="built_in">echo</span> <span class="string">&#x27;[Unit]</span></span><br><span class="line"><span class="string">Description=MongoS</span></span><br><span class="line"><span class="string">After=network.target</span></span><br><span class="line"><span class="string">Documentation=https://docs.mongodb.org/manual</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[Service]</span></span><br><span class="line"><span class="string">User=mongod</span></span><br><span class="line"><span class="string">Group=mongod</span></span><br><span class="line"><span class="string">Environment=&quot;OPTIONS=-f /etc/mongos.conf&quot;</span></span><br><span class="line"><span class="string">EnvironmentFile=-/etc/sysconfig/mongod</span></span><br><span class="line"><span class="string">ExecStart=/usr/bin/mongos $OPTIONS</span></span><br><span class="line"><span class="string">ExecStartPre=/usr/bin/mkdir -p /var/run/mongodb</span></span><br><span class="line"><span class="string">ExecStartPre=/usr/bin/chown mongod:mongod /var/run/mongodb</span></span><br><span class="line"><span class="string">ExecStartPre=/usr/bin/chmod 0755 /var/run/mongodb</span></span><br><span class="line"><span class="string">PermissionsStartOnly=true</span></span><br><span class="line"><span class="string">PIDFile=/var/run/mongodb/mongos.pid</span></span><br><span class="line"><span class="string">Type=forking</span></span><br><span class="line"><span class="string"># file size</span></span><br><span class="line"><span class="string">LimitFSIZE=infinity</span></span><br><span class="line"><span class="string"># cpu time</span></span><br><span class="line"><span class="string">LimitCPU=infinity</span></span><br><span class="line"><span class="string"># virtual memory size</span></span><br><span class="line"><span class="string">LimitAS=infinity</span></span><br><span class="line"><span class="string"># open files</span></span><br><span class="line"><span class="string">LimitNOFILE=64000</span></span><br><span class="line"><span class="string"># processes/threads</span></span><br><span class="line"><span class="string">LimitNPROC=64000</span></span><br><span class="line"><span class="string"># locked memory</span></span><br><span class="line"><span class="string">LimitMEMLOCK=infinity</span></span><br><span class="line"><span class="string"># total threads (user+kernel)</span></span><br><span class="line"><span class="string">TasksMax=infinity</span></span><br><span class="line"><span class="string">TasksAccounting=false</span></span><br><span class="line"><span class="string"># Recommended limits for mongod as specified in</span></span><br><span class="line"><span class="string"># http://docs.mongodb.org/manual/reference/ulimit/#recommended-settings</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[Install]</span></span><br><span class="line"><span class="string">WantedBy=multi-user.target&#x27;</span> &gt; /usr/lib/systemd/system/mongos.service</span><br><span class="line"></span><br><span class="line">  systemctl daemon-reload</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> AddShards &#123;</span><br><span class="line">  FILE=/tmp/mongo_add_shards.js</span><br><span class="line">  <span class="built_in">echo</span> <span class="string">&quot;use admin;&quot;</span> &gt; <span class="variable">$FILE</span></span><br><span class="line">  <span class="keyword">for</span> ((i = 1; i &lt;= <span class="variable">$NUM_SHARD</span>; ++i)); <span class="keyword">do</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;db.runCommand(&#123;addshard:\&quot;shard<span class="variable">$i</span>/<span class="variable">$BIND_IP</span>:$[D_PORT+i-1]\&quot;&#125;);&quot;</span> &gt;&gt; <span class="variable">$FILE</span></span><br><span class="line">  <span class="keyword">done</span></span><br><span class="line"></span><br><span class="line">  mongo --port <span class="variable">$S_PORT</span> &lt; <span class="variable">$FILE</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">CreateMongoSConfig</span><br><span class="line">CreateMongoSService</span><br><span class="line"></span><br><span class="line">systemctl restart mongos.service</span><br><span class="line"></span><br><span class="line">AddShards</span><br></pre></td></tr></table></figure>
<h3 id="9-【可选】配置-keyfile">9. 【可选】配置 keyfile</h3>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> ConfigKeyfile &#123;</span><br><span class="line">  FILE=/etc/mongodb-keyfile</span><br><span class="line">  openssl rand -base64 745 &gt; <span class="variable">$FILE</span></span><br><span class="line">  chown mongod. <span class="variable">$FILE</span></span><br><span class="line">  chmod 600 <span class="variable">$FILE</span></span><br><span class="line"></span><br><span class="line">  grep -P <span class="string">&#x27;^#keyFile&#x27;</span> /etc/mongod*.conf  &amp;&amp;  sed -i <span class="string">&#x27;s/#keyFile/keyFile/g&#x27;</span> /etc/mongod*.conf</span><br><span class="line"></span><br><span class="line">  grep -P <span class="string">&#x27;^#keyFile&#x27;</span> /etc/mongos.conf  &amp;&amp;  sed -i <span class="string">&#x27;s/#keyFile/keyFile/g&#x27;</span> /etc/mongos.conf</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> RestartMongo &#123;</span><br><span class="line">  systemctl restart mongod.service</span><br><span class="line">  <span class="keyword">for</span> ((i = 1; i &lt;= <span class="variable">$NUM_SHARD</span>; ++i)); <span class="keyword">do</span></span><br><span class="line">    systemctl restart mongod_shard<span class="variable">$i</span>.service;</span><br><span class="line">  <span class="keyword">done</span></span><br><span class="line">  systemctl restart mongos.service</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ConfigKeyfile</span><br><span class="line">RestartMongo</span><br></pre></td></tr></table></figure>
<h3 id="10-【可选】配置集合和创建索引">10. 【可选】配置集合和创建索引</h3>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">use EOS</span><br><span class="line">db.action_traces.createIndex(&#123;&quot;act.account&quot;: 1, &quot;_id&quot;:1&#125;,&#123;background: true, sparse: true&#125;)</span><br><span class="line">db.action_traces.createIndex(&#123;&quot;act.name&quot;: 1, &quot;_id&quot;:1&#125;,&#123;background: true, sparse: true&#125;)</span><br><span class="line">db.action_traces.createIndex(&#123;&quot;act.data.receiver&quot;: 1, &quot;_id&quot;:1&#125;,&#123;background: true, sparse: true&#125;)</span><br><span class="line">db.action_traces.createIndex(&#123;&quot;act.data.from&quot;: 1, &quot;_id&quot;:1&#125;,&#123;background: true, sparse: true&#125;)</span><br><span class="line">db.action_traces.createIndex(&#123;&quot;act.data.to&quot;: 1, &quot;_id&quot;:1&#125;,&#123;background: true, sparse: true&#125;)</span><br><span class="line">db.action_traces.createIndex(&#123;&quot;act.data.name&quot;: 1, &quot;_id&quot;:1&#125;,&#123;background: true, sparse: true&#125;)</span><br><span class="line">db.action_traces.createIndex(&#123;&quot;act.data.voter&quot;: 1, &quot;_id&quot;:1&#125;,&#123;background: true, sparse: true&#125;)</span><br><span class="line">db.action_traces.createIndex(&#123;&quot;act.authorization.actor&quot;: 1, &quot;_id&quot;:1&#125;,&#123;background: true, sparse: true&#125;)</span><br><span class="line">db.action_traces.createIndex(&#123;&quot;receipt.receiver&quot;: 1, &quot;_id&quot;:1&#125;,&#123;background: true, sparse: true&#125;)</span><br><span class="line"></span><br><span class="line">db.action_traces.createIndex(&#123;&quot;block_num&quot;: 1, &quot;_id&quot;:1&#125;,&#123;background: true&#125;)</span><br><span class="line">db.action_traces.createIndex(&#123;&quot;block_time&quot;: 1, &quot;_id&quot;:1&#125;,&#123;background: true&#125;)</span><br><span class="line"></span><br><span class="line">db.transaction_traces.createIndex(&#123;&quot;id&quot;: 1, &quot;_id&quot;:1&#125;,&#123;background: true&#125;)</span><br><span class="line"></span><br><span class="line">sh.enableSharding(&quot;EOS&quot;)</span><br><span class="line">sh.shardCollection(&quot;EOS.action_traces&quot;, &#123;&quot;_id&quot; : 1&#125;,  true)</span><br><span class="line">sh.shardCollection(&quot;EOS.transaction_traces&quot;, &#123;&quot;_id&quot; : 1&#125;,  true)</span><br></pre></td></tr></table></figure>
<h3 id="11-【可选】安装-EOSIO-1-5">11. 【可选】安装 EOSIO 1.5</h3>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wget https://github.com/eosio/eos/releases/download/v1.5.0/eosio-1.5.0-1.el7.x86_64.rpm</span><br><span class="line">rpm -ivh ./eosio-1.5.0-1.el7.x86_64.rpm --nodeps</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      
        <a data-url="https://blog.umu618.com/2018/12/11/umutech-mongodb-on-centos/" data-id="cm3zebrdi011qfk7mb9xk6taj" class="article-share-link" data-share="baidu" data-title="为 EOSIO MongoDB 插件搭建高可用集群">分享到</a>
      

      
        <a href="https://blog.umu618.com/2018/12/11/umutech-mongodb-on-centos/#SOHUCS" class="article-comment-link">评论</a>
      

      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/linux/" rel="tag">linux</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/mongodb/" rel="tag">mongodb</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ops/" rel="tag">ops</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-umutech-downgrade-boost-for-eosio" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/12/10/umutech-downgrade-boost-for-eosio/" class="article-date">
  <time datetime="2018-12-10T08:07:02.000Z" itemprop="datePublished">2018-12-10 16:07:02</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/UMUTech/">UMUTech</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/12/10/umutech-downgrade-boost-for-eosio/">为编译 EOSIO 降级 boost 到 1.67</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="问题">问题</h2>
<p>目前 EOSIO 1.5 依赖的 boost 版本为 1.67，但最新的 boost 是 1.68，如果不小心用 <code>brew upgrade</code> 把 boost 升级到最新，则 EOSIO 代码将无法顺利编译。</p>
<h2 id="解决">解决</h2>
<p>不必删除 1.68 版本，当之前安装过 1.67，再安装 1.68 时，其实两者是同时存在的，只是系统目录下的链接是指向最新版本而已。只要把链接改回 1.67 即可。</p>
<p>以下脚本适用于 macOS Mojave 系统，其它系统请自行做相应修改。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br></pre></td><td class="code"><pre><span class="line">ln -s /usr/<span class="built_in">local</span>/include/boost /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/include/boost </span><br><span class="line"></span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_atomic-mt.a /usr/<span class="built_in">local</span>/lib/libboost_atomic-mt.a</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_atomic-mt.dylib /usr/<span class="built_in">local</span>/lib/libboost_atomic-mt.dylib</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_chrono-mt.a /usr/<span class="built_in">local</span>/lib/libboost_chrono-mt.a</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_chrono-mt.dylib /usr/<span class="built_in">local</span>/lib/libboost_chrono-mt.dylib</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_chrono.a /usr/<span class="built_in">local</span>/lib/libboost_chrono.a</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_chrono.dylib /usr/<span class="built_in">local</span>/lib/libboost_chrono.dylib</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_container-mt.a /usr/<span class="built_in">local</span>/lib/libboost_container-mt.a</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_container-mt.dylib /usr/<span class="built_in">local</span>/lib/libboost_container-mt.dylib</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_container.a /usr/<span class="built_in">local</span>/lib/libboost_container.a</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_container.dylib /usr/<span class="built_in">local</span>/lib/libboost_container.dylib</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_context-mt.a /usr/<span class="built_in">local</span>/lib/libboost_context-mt.a</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_context-mt.dylib /usr/<span class="built_in">local</span>/lib/libboost_context-mt.dylib</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_contract-mt.a /usr/<span class="built_in">local</span>/lib/libboost_contract-mt.a</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_contract-mt.dylib /usr/<span class="built_in">local</span>/lib/libboost_contract-mt.dylib</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_contract.a /usr/<span class="built_in">local</span>/lib/libboost_contract.a</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_contract.dylib /usr/<span class="built_in">local</span>/lib/libboost_contract.dylib</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_coroutine-mt.a /usr/<span class="built_in">local</span>/lib/libboost_coroutine-mt.a</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_coroutine-mt.dylib /usr/<span class="built_in">local</span>/lib/libboost_coroutine-mt.dylib</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_coroutine.a /usr/<span class="built_in">local</span>/lib/libboost_coroutine.a</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_coroutine.dylib /usr/<span class="built_in">local</span>/lib/libboost_coroutine.dylib</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_date_time-mt.a /usr/<span class="built_in">local</span>/lib/libboost_date_time-mt.a</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_date_time-mt.dylib /usr/<span class="built_in">local</span>/lib/libboost_date_time-mt.dylib</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_date_time.a /usr/<span class="built_in">local</span>/lib/libboost_date_time.a</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_date_time.dylib /usr/<span class="built_in">local</span>/lib/libboost_date_time.dylib</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_exception-mt.a /usr/<span class="built_in">local</span>/lib/libboost_exception-mt.a</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_exception.a /usr/<span class="built_in">local</span>/lib/libboost_exception.a</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_fiber-mt.a /usr/<span class="built_in">local</span>/lib/libboost_fiber-mt.a</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_fiber-mt.dylib /usr/<span class="built_in">local</span>/lib/libboost_fiber-mt.dylib</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_filesystem-mt.a /usr/<span class="built_in">local</span>/lib/libboost_filesystem-mt.a</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_filesystem-mt.dylib /usr/<span class="built_in">local</span>/lib/libboost_filesystem-mt.dylib</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_filesystem.a /usr/<span class="built_in">local</span>/lib/libboost_filesystem.a</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_filesystem.dylib /usr/<span class="built_in">local</span>/lib/libboost_filesystem.dylib</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_graph-mt.a /usr/<span class="built_in">local</span>/lib/libboost_graph-mt.a</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_graph-mt.dylib /usr/<span class="built_in">local</span>/lib/libboost_graph-mt.dylib</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_graph.a /usr/<span class="built_in">local</span>/lib/libboost_graph.a</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_graph.dylib /usr/<span class="built_in">local</span>/lib/libboost_graph.dylib</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_iostreams-mt.a /usr/<span class="built_in">local</span>/lib/libboost_iostreams-mt.a</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_iostreams-mt.dylib /usr/<span class="built_in">local</span>/lib/libboost_iostreams-mt.dylib</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_iostreams.a /usr/<span class="built_in">local</span>/lib/libboost_iostreams.a</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_iostreams.dylib /usr/<span class="built_in">local</span>/lib/libboost_iostreams.dylib</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_locale-mt.a /usr/<span class="built_in">local</span>/lib/libboost_locale-mt.a</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_locale-mt.dylib /usr/<span class="built_in">local</span>/lib/libboost_locale-mt.dylib</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_log-mt.a /usr/<span class="built_in">local</span>/lib/libboost_log-mt.a</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_log-mt.dylib /usr/<span class="built_in">local</span>/lib/libboost_log-mt.dylib</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_log.a /usr/<span class="built_in">local</span>/lib/libboost_log.a</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_log.dylib /usr/<span class="built_in">local</span>/lib/libboost_log.dylib</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_log_setup-mt.a /usr/<span class="built_in">local</span>/lib/libboost_log_setup-mt.a</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_log_setup-mt.dylib /usr/<span class="built_in">local</span>/lib/libboost_log_setup-mt.dylib</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_log_setup.a /usr/<span class="built_in">local</span>/lib/libboost_log_setup.a</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_log_setup.dylib /usr/<span class="built_in">local</span>/lib/libboost_log_setup.dylib</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_math_c99-mt.a /usr/<span class="built_in">local</span>/lib/libboost_math_c99-mt.a</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_math_c99-mt.dylib /usr/<span class="built_in">local</span>/lib/libboost_math_c99-mt.dylib</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_math_c99.a /usr/<span class="built_in">local</span>/lib/libboost_math_c99.a</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_math_c99.dylib /usr/<span class="built_in">local</span>/lib/libboost_math_c99.dylib</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_math_c99f-mt.a /usr/<span class="built_in">local</span>/lib/libboost_math_c99f-mt.a</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_math_c99f-mt.dylib /usr/<span class="built_in">local</span>/lib/libboost_math_c99f-mt.dylib</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_math_c99f.a /usr/<span class="built_in">local</span>/lib/libboost_math_c99f.a</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_math_c99f.dylib /usr/<span class="built_in">local</span>/lib/libboost_math_c99f.dylib</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_math_c99l-mt.a /usr/<span class="built_in">local</span>/lib/libboost_math_c99l-mt.a</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_math_c99l-mt.dylib /usr/<span class="built_in">local</span>/lib/libboost_math_c99l-mt.dylib</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_math_c99l.a /usr/<span class="built_in">local</span>/lib/libboost_math_c99l.a</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_math_c99l.dylib /usr/<span class="built_in">local</span>/lib/libboost_math_c99l.dylib</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_math_tr1-mt.a /usr/<span class="built_in">local</span>/lib/libboost_math_tr1-mt.a</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_math_tr1-mt.dylib /usr/<span class="built_in">local</span>/lib/libboost_math_tr1-mt.dylib</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_math_tr1.a /usr/<span class="built_in">local</span>/lib/libboost_math_tr1.a</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_math_tr1.dylib /usr/<span class="built_in">local</span>/lib/libboost_math_tr1.dylib</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_math_tr1f-mt.a /usr/<span class="built_in">local</span>/lib/libboost_math_tr1f-mt.a</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_math_tr1f-mt.dylib /usr/<span class="built_in">local</span>/lib/libboost_math_tr1f-mt.dylib</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_math_tr1f.a /usr/<span class="built_in">local</span>/lib/libboost_math_tr1f.a</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_math_tr1f.dylib /usr/<span class="built_in">local</span>/lib/libboost_math_tr1f.dylib</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_math_tr1l-mt.a /usr/<span class="built_in">local</span>/lib/libboost_math_tr1l-mt.a</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_math_tr1l-mt.dylib /usr/<span class="built_in">local</span>/lib/libboost_math_tr1l-mt.dylib</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_math_tr1l.a /usr/<span class="built_in">local</span>/lib/libboost_math_tr1l.a</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_math_tr1l.dylib /usr/<span class="built_in">local</span>/lib/libboost_math_tr1l.dylib</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_prg_exec_monitor-mt.a /usr/<span class="built_in">local</span>/lib/libboost_prg_exec_monitor-mt.a</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_prg_exec_monitor-mt.dylib /usr/<span class="built_in">local</span>/lib/libboost_prg_exec_monitor-mt.dylib</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_prg_exec_monitor.a /usr/<span class="built_in">local</span>/lib/libboost_prg_exec_monitor.a</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_prg_exec_monitor.dylib /usr/<span class="built_in">local</span>/lib/libboost_prg_exec_monitor.dylib</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_program_options-mt.a /usr/<span class="built_in">local</span>/lib/libboost_program_options-mt.a</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_program_options-mt.dylib /usr/<span class="built_in">local</span>/lib/libboost_program_options-mt.dylib</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_program_options.a /usr/<span class="built_in">local</span>/lib/libboost_program_options.a</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_program_options.dylib /usr/<span class="built_in">local</span>/lib/libboost_program_options.dylib</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_random-mt.a /usr/<span class="built_in">local</span>/lib/libboost_random-mt.a</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_random-mt.dylib /usr/<span class="built_in">local</span>/lib/libboost_random-mt.dylib</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_random.a /usr/<span class="built_in">local</span>/lib/libboost_random.a</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_random.dylib /usr/<span class="built_in">local</span>/lib/libboost_random.dylib</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_regex-mt.a /usr/<span class="built_in">local</span>/lib/libboost_regex-mt.a</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_regex-mt.dylib /usr/<span class="built_in">local</span>/lib/libboost_regex-mt.dylib</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_regex.a /usr/<span class="built_in">local</span>/lib/libboost_regex.a</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_regex.dylib /usr/<span class="built_in">local</span>/lib/libboost_regex.dylib</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_serialization-mt.a /usr/<span class="built_in">local</span>/lib/libboost_serialization-mt.a</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_serialization-mt.dylib /usr/<span class="built_in">local</span>/lib/libboost_serialization-mt.dylib</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_serialization.a /usr/<span class="built_in">local</span>/lib/libboost_serialization.a</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_serialization.dylib /usr/<span class="built_in">local</span>/lib/libboost_serialization.dylib</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_signals-mt.a /usr/<span class="built_in">local</span>/lib/libboost_signals-mt.a</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_signals-mt.dylib /usr/<span class="built_in">local</span>/lib/libboost_signals-mt.dylib</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_signals.a /usr/<span class="built_in">local</span>/lib/libboost_signals.a</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_signals.dylib /usr/<span class="built_in">local</span>/lib/libboost_signals.dylib</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_stacktrace_addr2line-mt.a /usr/<span class="built_in">local</span>/lib/libboost_stacktrace_addr2line-mt.a</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_stacktrace_addr2line-mt.dylib /usr/<span class="built_in">local</span>/lib/libboost_stacktrace_addr2line-mt.dylib</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_stacktrace_addr2line.a /usr/<span class="built_in">local</span>/lib/libboost_stacktrace_addr2line.a</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_stacktrace_addr2line.dylib /usr/<span class="built_in">local</span>/lib/libboost_stacktrace_addr2line.dylib</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_stacktrace_basic-mt.a /usr/<span class="built_in">local</span>/lib/libboost_stacktrace_basic-mt.a</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_stacktrace_basic-mt.dylib /usr/<span class="built_in">local</span>/lib/libboost_stacktrace_basic-mt.dylib</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_stacktrace_basic.a /usr/<span class="built_in">local</span>/lib/libboost_stacktrace_basic.a</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_stacktrace_basic.dylib /usr/<span class="built_in">local</span>/lib/libboost_stacktrace_basic.dylib</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_stacktrace_noop-mt.a /usr/<span class="built_in">local</span>/lib/libboost_stacktrace_noop-mt.a</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_stacktrace_noop-mt.dylib /usr/<span class="built_in">local</span>/lib/libboost_stacktrace_noop-mt.dylib</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_stacktrace_noop.a /usr/<span class="built_in">local</span>/lib/libboost_stacktrace_noop.a</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_stacktrace_noop.dylib /usr/<span class="built_in">local</span>/lib/libboost_stacktrace_noop.dylib</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_system-mt.a /usr/<span class="built_in">local</span>/lib/libboost_system-mt.a</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_system-mt.dylib /usr/<span class="built_in">local</span>/lib/libboost_system-mt.dylib</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_system.a /usr/<span class="built_in">local</span>/lib/libboost_system.a</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_system.dylib /usr/<span class="built_in">local</span>/lib/libboost_system.dylib</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_test_exec_monitor-mt.a /usr/<span class="built_in">local</span>/lib/libboost_test_exec_monitor-mt.a</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_test_exec_monitor.a /usr/<span class="built_in">local</span>/lib/libboost_test_exec_monitor.a</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_thread-mt.a /usr/<span class="built_in">local</span>/lib/libboost_thread-mt.a</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_thread-mt.dylib /usr/<span class="built_in">local</span>/lib/libboost_thread-mt.dylib</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_timer-mt.a /usr/<span class="built_in">local</span>/lib/libboost_timer-mt.a</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_timer-mt.dylib /usr/<span class="built_in">local</span>/lib/libboost_timer-mt.dylib</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_timer.a /usr/<span class="built_in">local</span>/lib/libboost_timer.a</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_timer.dylib /usr/<span class="built_in">local</span>/lib/libboost_timer.dylib</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_type_erasure-mt.a /usr/<span class="built_in">local</span>/lib/libboost_type_erasure-mt.a</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_type_erasure-mt.dylib /usr/<span class="built_in">local</span>/lib/libboost_type_erasure-mt.dylib</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_type_erasure.a /usr/<span class="built_in">local</span>/lib/libboost_type_erasure.a</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_type_erasure.dylib /usr/<span class="built_in">local</span>/lib/libboost_type_erasure.dylib</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_unit_test_framework-mt.a /usr/<span class="built_in">local</span>/lib/libboost_unit_test_framework-mt.a</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_unit_test_framework-mt.dylib /usr/<span class="built_in">local</span>/lib/libboost_unit_test_framework-mt.dylib</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_unit_test_framework.a /usr/<span class="built_in">local</span>/lib/libboost_unit_test_framework.a</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_unit_test_framework.dylib /usr/<span class="built_in">local</span>/lib/libboost_unit_test_framework.dylib</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_wave-mt.a /usr/<span class="built_in">local</span>/lib/libboost_wave-mt.a</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_wave-mt.dylib /usr/<span class="built_in">local</span>/lib/libboost_wave-mt.dylib</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_wserialization-mt.a /usr/<span class="built_in">local</span>/lib/libboost_wserialization-mt.a</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_wserialization-mt.dylib /usr/<span class="built_in">local</span>/lib/libboost_wserialization-mt.dylib</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_wserialization.a /usr/<span class="built_in">local</span>/lib/libboost_wserialization.a</span><br><span class="line">ln -f /usr/<span class="built_in">local</span>/Cellar/boost/1.67.0_1/lib/libboost_wserialization.dylib /usr/<span class="built_in">local</span>/lib/libboost_wserialization.dylib</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      
        <a data-url="https://blog.umu618.com/2018/12/10/umutech-downgrade-boost-for-eosio/" data-id="cm3zebrdh011nfk7mhrov6pq7" class="article-share-link" data-share="baidu" data-title="为编译 EOSIO 降级 boost 到 1.67">分享到</a>
      

      
        <a href="https://blog.umu618.com/2018/12/10/umutech-downgrade-boost-for-eosio/#SOHUCS" class="article-comment-link">评论</a>
      

      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/debug/" rel="tag">debug</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/macos/" rel="tag">macos</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-reconstructionism-poet-fat" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/12/02/reconstructionism-poet-fat/" class="article-date">
  <time datetime="2018-12-01T16:21:00.000Z" itemprop="datePublished">2018-12-02 00:21:00</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E8%AF%97%E7%9B%97/">诗盗</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/12/02/reconstructionism-poet-fat/">诗盗·肥</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>《#诗盗#·肥》：巨婴口欲吃乐射，横纹小腹双下巴。一喊减肥先减胸，中年妇女肿么了？</p>
<h2 id="注解">注解</h2>
<p>穷和老都会导致肥胖。</p>

      
    </div>
    <footer class="article-footer">
      
        <a data-url="https://blog.umu618.com/2018/12/02/reconstructionism-poet-fat/" data-id="cm3zebrdh011kfk7m51xa4srm" class="article-share-link" data-share="baidu" data-title="诗盗·肥">分享到</a>
      

      
        <a href="https://blog.umu618.com/2018/12/02/reconstructionism-poet-fat/#SOHUCS" class="article-comment-link">评论</a>
      

      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E4%B8%83%E5%BE%8B/" rel="tag">七律</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%96%B7/" rel="tag">喷</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-umutech-effective-cpp" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/11/26/umutech-effective-cpp/" class="article-date">
  <time datetime="2018-11-26T15:22:15.000Z" itemprop="datePublished">2018-11-26 23:22:15</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/UMUTech/">UMUTech</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/11/26/umutech-effective-cpp/">《Effective C++》读书笔记</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="第一章-让自己习惯-C">第一章 让自己习惯 C++</h2>
<h3 id="1-视-C-为一个语言联邦">1. 视 C++ 为一个语言联邦</h3>
<p>C++ 是个多重范型编程语言：面向过程、面向对象、函数式、泛型、原编程式，所以他的规约很多，记住四个次语言可以帮助了解 C++：C、Object-Oriented C++、Template C++、STL。</p>
<h3 id="2-尽量以-const、enum、inline-替换-define">2. 尽量以 const、enum、inline 替换 #define</h3>
<p>他们的根本差别是：前三者是编译器处理的，最后者是预处理器处理的。enum 比 const 更像 #define，比如说 const 定义通常可以求地址或引用，而 enum 不行。</p>
<p>inline 函数比宏多了类型安全和可预料性，一个例子是将 i++ 或 ++i 当参数传给宏时，可能导致 ++ 了多次，而传给 inline 函数则不会。</p>
<h3 id="3-尽可能使用-const">3. 尽可能使用 const</h3>
<p>const 可以帮助编译器侦测错误的用法。例如，令函数返回一个常量值，往往可降低因调用者错误而造成的意外，而又不至于放弃安全性和高效性。比如当比较语句少写了一个 = 时：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 本意是 ==，结果导致在 a * b 的临时变量上调用 operator=</span></span><br><span class="line"><span class="keyword">if</span> (a * b = c) ...</span><br></pre></td></tr></table></figure>
<p>如果 operator= 返回值不是 const 会导致以上错误代码编译通过！</p>
<p>bitwise constness 认为 const 成员函数不可以更改对象内任何 non-static 成员变量，logical constness 主张在调用者侦测不出的前提下可以修改对象内某些 bits，可以利用 mutable 释放掉 non-static 成员变量的 bitwise constness 约束。</p>
<p>在 const 和 non-const 成员函数中避免重复的做法是：让 non-const 成员函数调用 const 成员函数，而不要反过来。</p>
<h3 id="4-确定对象被使用前已被初始化">4. 确定对象被使用前已被初始化</h3>
<p>为内置型对象进行手工初始化，因为 C++ 不保证初始化它们。</p>
<p>构造函数最好使用成员初值列，而不是赋值操作，排列顺序最好和声明次序想同。</p>
<p>为避免跨编译单元的初始化次序问题，用 local static 对象代替 non-local static 对象，参考 Singleton 模式常见实现。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">XClass&amp; <span class="title">GetInstance</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">static</span> XClass instance;</span><br><span class="line">    <span class="keyword">return</span> instance;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="第二章-构造-析构-赋值运算">第二章 构造/析构/赋值运算</h2>
<h3 id="5-了解-C-默默编写并调用哪些函数">5. 了解 C++ 默默编写并调用哪些函数</h3>
<p>编译器可以隐式为类创建：默认构造函数、复制构造函数、赋值构造函数、析构函数。</p>
<h3 id="6-若不想使用编译器自动产生的函数，就应该明确拒绝">6. 若不想使用编译器自动产生的函数，就应该明确拒绝</h3>
<p>拒绝的普遍方法是：把函数设为 private，只有声明没有实现。但 member 函数和 friend 函数还是可以调用 private 函数，由于没有实现，会在连接期报错，不利排插，将错误移至编译期的方法是：private 继承 Uncopyable 类，Boost 也有个类，名为 noncopyable。</p>
<p>更新式的做法是把函数声明为 = delete。</p>
<h3 id="7-为多态基类声明-virtual-析构函数">7. 为多态基类声明 virtual 析构函数</h3>
<p>任何类只要带有 virtual 函数，都几乎确定应该有一个 virtual 析构函数。但有 virtual 函数会降低调用效率和可优化性，所以能不用则不用，比如说，某个类没有考虑作为基类（base class）被继承，则没有必要有 virtual 析构函数，STL 的容器大多如此。</p>
<h3 id="8-别让异常逃离析构函数">8. 别让异常逃离析构函数</h3>
<p>如果一个被析构函数调用的函数可能抛出异常，析构函数应该捕捉任何异常，然后吞下他们或者结束程序。</p>
<p>如果客户需要对某个函数运行期间抛出的异常做出反应，那么类应该提供一个普通函数执行该操作，而非在析构函数中。</p>
<h3 id="9-绝不在构造和析构过程中调用-virtual-函数">9. 绝不在构造和析构过程中调用 virtual 函数</h3>
<p>因为这类调用从不降至派生类（derived class），它将调用本层的函数。</p>
<h3 id="10-令-operator-返回一个-reference-to-this">10. 令 operator= 返回一个 reference to *this</h3>
<p>这样才能支持连锁赋值，a = b = c = d。</p>
<h3 id="11-在-operator-中处理“自我赋值”">11. 在 operator= 中处理“自我赋值”</h3>
<p>方法有：比较来源和目标对象的地址、精心周到的语句顺序、copy-and-swap。要考虑自我赋值的概率，如果很小，则比较地址的方式可能并不好，因为无视它效率更高。</p>
<h3 id="12-复制对象时勿忘其每一个成分">12. 复制对象时勿忘其每一个成分</h3>
<p>复制函数应该保证复制“对象内的所有成员变量”及“所有基类成分”。当你编写一个复制函数，请确保（1）复制所有 local 成员变量，（2）调用所有基类内的适当的复制函数。</p>
<p>不要尝试以某个复制函数实现另一个复制函数。应该将共同机能放进第三个函数中，并由两个复制函数共同调用。</p>
<h2 id="第三章-资源管理">第三章 资源管理</h2>
<h3 id="13-以对象管理资源">13. 以对象管理资源</h3>
<p>获得资源后立刻放进对象（managing object）内。“以对象管理资源”又称“资源取得时机就是初始化时机”（Resource Acquisition Is Initialization; RAII）</p>
<p>管理对象（managing object）运用析构函数确保资源被释放。</p>
<p>为防止资源泄漏，请使用 RAII 对象，它们在构造函数中获得资源并在析构函数中释放资源。</p>
<p>常被使用的 RAII class 是 std::shared_ptr，它是“引用计数器型智能指针”（Reference-counting smart pointer; RCSP），它无法打破环形引用（cycles of reference）。</p>
<p>不要用智能指针管理动态分配的数组，因为会导致错误形式的释放。参考《<a target="_blank" rel="noopener" href="https://my.oschina.net/umu618/blog/818839">[C++ 学习笔记 1] delete 和 delete [] 的本质区别</a>》。</p>
<h3 id="a-name-item14-14-在资源管理类中小心-coping-行为-a"><a name="item14">14. 在资源管理类中小心 coping 行为</a></h3>
<p>复制 RAII 对象必须一并复制它管理的资源，常见的 RAII class copying 行为是：</p>
<p>（1）禁止复制；</p>
<p>（2）对底层资源祭出“引用计数法”（reference-count）；</p>
<p>（3）复制底部资源；</p>
<p>（4）转移底部资源的拥有权。</p>
<h3 id="15-在资源管理类中提供对原始资源的访问">15. 在资源管理类中提供对原始资源的访问</h3>
<p>APIs 往往要求访问原始资源（raw resource），所以每一个 RAII class 应该提供一个“取得其所管理之资源”的方法，比如 .get()。</p>
<p>对原始资源的访问可能经由显式转换或隐式转换。一般而言，显式转换比较安全，但隐式转换对客户比较方便。</p>
<h3 id="16-成对使用-new-和-delete-时要采取相同形式">16. 成对使用 new 和 delete 时要采取相同形式</h3>
<p>如果你在 new 表达式中使用 []，必须在相应的 delete 表达式中也使用 []。如果你在 new 表达式中不使用 []，一定不要在相应的 delete 表达式中使用 []。参考《<a target="_blank" rel="noopener" href="https://my.oschina.net/umu618/blog/818839">[C++ 学习笔记 1] delete 和 delete [] 的本质区别</a>》。</p>
<h3 id="17-以独立语句将-newed-对象置入智能指针">17. 以独立语句将 newed 对象置入智能指针</h3>
<p>以独立语句将 newed 对象存储于（置入）智能指针内。如果不这么做，一旦异常被抛出，有可能导致难以察觉的资源泄漏。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 编译器可能为了产生更高效代码，而弹性地改变三个元语句的执行顺序</span></span><br><span class="line"><span class="comment">// 如果 priority() 抛出异常，可能导致 new Widget 返回的指针遗失</span></span><br><span class="line">processWidget(<span class="built_in">std</span>::<span class="built_in">shared_ptr</span>&lt;Widget&gt;(<span class="keyword">new</span> Widget), priority());</span><br><span class="line"></span><br><span class="line"><span class="comment">// 以下独立语句可行，因为编译器对“跨越语句的各项操作”没有重新排序的自由。</span></span><br><span class="line"><span class="function"><span class="built_in">std</span>::<span class="built_in">shared_ptr</span>&lt;Widget&gt; <span class="title">pw</span><span class="params">(<span class="keyword">new</span> Widget)</span></span>;</span><br><span class="line">processWidget(pw, priority());</span><br></pre></td></tr></table></figure>
<h2 id="第四章-设计与声明">第四章 设计与声明</h2>
<h3 id="18-让接口容易被正确使用，不易被误用">18. 让接口容易被正确使用，不易被误用</h3>
<p>“促进正确使用”的办法包括接口的一致性，以及与内置类型的行为兼容。一致性的例子：STL 容器都有 size 成员函数。不一致性对开发人员造成的心理负担，没有任何一个 IDE 可以完全抹除。</p>
<p>“阻止误用”的办法包括建立新类型、限制类型上的操作，束缚对象值，以及消除客户的资源管理责任。</p>
<p>std::shared_ptr 使用每个指针专属的删除器，消除“cross-DLL problem”；它还支持定制删除器，可被用来自动解除互斥锁（mutexes，见<a href="#item14">条款 14</a>）。</p>
<h3 id="19-设计-class-犹如设计-type">19. 设计 class 犹如设计 type</h3>
<p>Class 设计就是 type 的设计，在定义一个新 type 之前，要考虑以下主题：</p>
<p>（1）新 type 的对象应该如何被创建和销毁？</p>
<p>（2）对象的初始化和赋值该有什么差别？</p>
<p>（3）新 type 的对象如果被以值传递（pass by value），意味着什么？</p>
<p>（4）什么的新 type 的合法值？setter 函数要检查错误。</p>
<p>（5）新 type 需要配合某个继承图系（inheritance graph）吗？这影响函数——尤其是析构函数，是否为 virtual（见<a href="#7-%E4%B8%BA%E5%A4%9A%E6%80%81%E5%9F%BA%E7%B1%BB%E5%A3%B0%E6%98%8E-virtual-%E6%9E%90%E6%9E%84%E5%87%BD%E6%95%B0">条款 7</a>）。</p>
<p>（6）新 type 需要什么样的转换？如果希望 T1 被隐式转换为 T2，必须在 class T1 内写一个类型转换函数（operator T2）或在 class T2 内写一个可被单一实参调用（non-explicit-one-argument）的构造函数。如果只允许 explicit 构造函数存在，就得写出专门负责转换的函数，且不得为类型转换操作符（type conversion perators）或 non-explicit-one-argument 构造函数。（条款 15 有隐式和显式转换函数的范例，<a target="_blank" rel="noopener" href="https://my.oschina.net/umu618/blog/839649">https://my.oschina.net/umu618/blog/839649</a>）</p>
<p>（7）什么样的操作符和函数对此新 type 而言是合理的？这决定你的 class 有哪些函数，其中哪些是 member 函数，哪些则否。（参考条款 23, 24, 26）</p>
<p>（8）什么样的标准函数应该驳回？声明为 private。（见<a href="#6-%E8%8B%A5%E4%B8%8D%E6%83%B3%E4%BD%BF%E7%94%A8%E7%BC%96%E8%AF%91%E5%99%A8%E8%87%AA%E5%8A%A8%E4%BA%A7%E7%94%9F%E7%9A%84%E5%87%BD%E6%95%B0%EF%BC%8C%E5%B0%B1%E5%BA%94%E8%AF%A5%E6%98%8E%E7%A1%AE%E6%8B%92%E7%BB%9D">条款 6</a>）</p>
<p>（9）谁该取用新 type 的成员？这个问题帮你决定成员的可见性（public、protected、private）。也帮你决定哪个 classes 和/或 functions 应该是 friends，以及将它们嵌套于另一个之内是否合理。</p>
<p>（10）什么是新 type 的未声明接口（undeclared interface）？它对效率、异常安全性（见条款 29）以及资源运用（例如多任务锁定和动态内存）提供何种保证？你在这些方面提供的保证，将为你的 class 实现代码加上相应的约束条件。</p>
<p>（11）新 type 有多么一般化？new class or new class template?</p>
<p>（12）真的需要一个新 type 吗？如果只是定义新的子类（derived class）以便为既有 class 添加机能，那么也许单纯定义一或多个 non-member 函数或</p>
<h3 id="20-宁以-pass-by-reference-to-const-替换-pass-by-value">20. 宁以 pass-by-reference-to-const 替换 pass-by-value</h3>
<p>尽量以 pass-by-reference-to-const 替换 pass-by-value。前者通常比较高效，并可避免切割问题（slicing problem，即派生类被转化成基类时丢失派生类特有的成分）。</p>
<p>以上规则并不适用于内置类型，以及 STL 的迭代器和函数对象。对它们而言，pass-by-value 往往比较适当。</p>
<h3 id="21-必须返回对象时，别妄想返回其-reference">21. 必须返回对象时，别妄想返回其 reference</h3>
<p>不要返回 pointer 或 reference 指向一个 local stack 对象，因为离开作用域即被销毁。</p>
<p>不要返回 reference 指向一个 heap-allocated 对象，因为无法保证配套 delete。</p>
<p>不要返回 pointer 或 reference 指向一个 local static 对象而有可能同时需要多个这样的对象。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> _WINSOCK_DEPRECATED_NO_WARNINGS <span class="comment">// to use inet_ntoa</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;winsock2.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> comment(lib, <span class="meta-string">&quot;ws2_32.lib&quot;</span>)</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    in_addr a1 = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>&#125;;</span><br><span class="line">    in_addr a2 = &#123;<span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>&#125;;</span><br><span class="line">    printf_s(<span class="string">&quot;You think it&#x27;s: %s, &quot;</span>, inet_ntoa(a1));</span><br><span class="line">    printf_s(<span class="string">&quot;%s\n&quot;</span>, inet_ntoa(a2));</span><br><span class="line">    printf_s(<span class="string">&quot;But in fact it&#x27;s: %s, %s\n&quot;</span>, inet_ntoa(a1), inet_ntoa(a2));</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>以上代码输出为：</p>
<blockquote>
<p>You think it’s: 1.2.3.4, 5.6.7.8<br>
But in fact it’s: 1.2.3.4, 1.2.3.4</p>
</blockquote>
<h3 id="22-将成员变量声明为-private">22. 将成员变量声明为 private</h3>
<p>切记将成员变量声明为 private。这可赋予客户访问数据的一致性、可细微划分访问控制、允诺约束条件获得保证，并提供 class 作者以充分的实现弹性。</p>
<p>protected 并不比 public 更具封装性。</p>
<h3 id="23-宁以-non-member、non-friend-替换-member-函数">23. 宁以 non-member、non-friend 替换 member 函数</h3>
<p>宁可拿 non-member non-friend 函数替换 member 函数。这样做可以增加封装型、包裹弹性（packaging flexibility）和技能扩充性。</p>
<h3 id="24-若所有参数皆需类型转换，请为此采用-non-member-函数">24. 若所有参数皆需类型转换，请为此采用 non-member 函数</h3>
<p>member 函数的反面是 non-member 函数，而不是 friend 函数。</p>
<p>设计 operator * 时，要能支持乘法交换律。</p>
<p>如果你需要为某个函数的所有参数（包括 this 指针所指的那个隐喻参数）进行类型转换，那么这个函数必须是个 non-member。从 Object-Oriented C++ 跨进 Template C++ 时，会有新争议和解法，参考条款 46。</p>
<h3 id="25-考虑写出一个不抛异常的-swap-函数">25. 考虑写出一个不抛异常的 swap 函数</h3>
<p>通常我们不能改变 std 命名空间内的任何东西，但可以为 temlates 制造特化版本。</p>
<p>C++ 只允许对 class templates 偏特化（partially specialize），而对 function templates 则不许。</p>
<p>当 std::swap 对你的类型效率不高时，提供一个 swap 成员函数，并确定这个函数不抛出异常。因为成员 swap 的一个最好应用是帮助 classes 和 class templates 提供强烈的异常安全性（exception-safety）保障。条款 29 细说。</p>
<p>如果你提供了一个 member swap，也该提供一个 non-member swap 用来调用前者。对于 classes（而非 templates），也请特化 std::swap。</p>
<p>调用 swap 时应针对 std::swap 使用 using 声明式，然后调用 swap 并不带任何“命名空间资格修饰”。</p>
<p>为“用户定义类型”进行 std templates 全特化是好的，但千万不要尝试在 std 内加入某些对 std 而言全新的东西。</p>
<h2 id="第五章-实现">第五章 实现</h2>
<h3 id="26-尽可能延后变量定义式的出现时间">26. 尽可能延后变量定义式的出现时间</h3>
<p>太早出现，可能因为下面出现异常，导致构造白白浪费。</p>
<p>延后可以增加程序的清晰度、改善效率。</p>
<h3 id="27-尽量少做转型动作">27. 尽量少做转型动作</h3>
<p>dynamic_casts 有性能代价，应该尽量避免。绝对要避免“连串动态转型”（cascading dynamic casts）。</p>
<p>如果转型是必要的，试着将它隐藏于某个函数。客户可以条用该函数，而不需要讲转型放进他们的代码内。</p>
<p>宁可使用 C+±style 转型，不要使用旧式转型。前者很容易辨识出来，而且有分门别类的职掌。</p>
<h3 id="28-避免返回-handles-指向对象内部成分">28. 避免返回 handles 指向对象内部成分</h3>
<p>避免返回 handles（包括 reference、指针、迭代器）指向对象内部，可以增加封装型，帮助 const 成员函数的行为像个 const，将发生“虚吊号码牌”（dangling handles）的可能性降至最低。</p>
<p>反之，传出去的 handles 可能让你暴露在“handles ”的风险下。</p>
<h3 id="29-为“异常安全”而努力是值得的">29. 为“异常安全”而努力是值得的</h3>
<p>当异常被抛出时，异常安全的函数会：（1）不泄漏任何资源；（2）不允许数据败坏。</p>
<p>异常安全函数（Exception-safe functions）提供这三个保证之一：（1）基本承诺，如果异常抛出，程序内的任何事物仍然保持在有效状态下。（2）强烈保证，如果异常抛出，程序状态不改变。（3）不抛掷（nothrow）保证，承诺绝不抛出异常。</p>
<p>“强烈保证”往往能够以 copy-and-swap 实现出来，但“强烈保证”并非对所有函数都可以实现或具备现实意义。</p>
<p>木桶原理：函数提供的“异常安全保证”通常最高只等于其所调用的各个函数的“异常安全保证”中的最弱者。</p>
<h3 id="30-透彻了解-inlining-的里里外外">30. 透彻了解 inlining 的里里外外</h3>
<p>将大多数 inlining 限制在小型、被频繁调用的函数身上。这可使日后的调试过程和二进制升级（binary upgradability）更容易，也可使潜在的代码膨胀问题最小化，使程序的速度提升机会最大化。</p>
<p>定义于 class 内的函数都隐性成为 inline，包括像 operator* 这样的 friend 函数。</p>
<p>不要只因为 function templates 出现在头文件，就将它们声明为 inline。</p>
<p>所有对 virtual 函数的调用（除非是最平淡无奇的）都会使 inlining 落空。</p>
<p>编译器通常不对“通过函数指针而进行的调用”实施 inlining，这意味着对 inline 函数的调用最终是否 inlined 由编译器决定。</p>
<p>构造函数和析构函数往往是 inlining 的糟糕候选，因为他们隐含一些由编译器产生的代码。</p>
<p>inline 函数的风险：它们无法随着程序库的升级而升级，必须重新编译。</p>
<h3 id="31-将文件间的编译依存关系降至最低">31. 将文件间的编译依存关系降至最低</h3>
<p>支持“编译依存性最小化”的一般构想是：相依于声明式，不要相依于定义式。基于此构想的两个手段是 Handle classes 和 Interface classes。</p>
<p>程序库头文件应该以“完全且仅有声明式”（full and declaration-only forms）的形式存在。这种做法适用于 templates。</p>
<p>（1）如果使用 object references 或 object pointers 可以完成任务，就不要使用 object。</p>
<p>（2）如果可以，尽量以 class 声明式替换 class 定义式。</p>
<p>（3）为声明式和定义式提供不同的头文件。</p>
<p>Java 和 .NET 都不允许在 Interfaces 内实现成员变量或成员函数，但 C++ 可以。</p>
<p>Handle classes 和 Interface classes 有微小的性能损失，但为了降低 classes 之间的耦合性是值得的。如果性能比耦合性重要，才用具象类（concrete ）替换它们。</p>
<h2 id="第六章-继承与面向对象设计">第六章 继承与面向对象设计</h2>
<h3 id="32-确定你的-public-继承塑模出-is-a-关系">32. 确定你的 public 继承塑模出 is-a 关系</h3>
<p>“public 继承”意味 is-a。适用于 base classes 身上的每一件事一定也适用于 derived classes 身上，因为每一个 derived classes 对象也都是一个 base class 对象。</p>
<p>classes 之间的关系除了 is-a 之外，还有 has-a（有一个）和 is-implemented-in-terms-of（根据某物实现出）两种常见的关系。</p>
<h3 id="33-避免遮掩继承而来的名称">33. 避免遮掩继承而来的名称</h3>
<p>derived classes 内的名称会掩盖 base classes 内的名称。在 public 继承下从来没有人希望如此。</p>
<p>为了让被掩盖的名称再见天日，可使用 using 声明式或转交函数（forwarding function）。</p>
<h3 id="34-区分接口继承和实现继承">34. 区分接口继承和实现继承</h3>
<p>接口继承和实现继承不同。在 public 继承之下，derived classes 总是继承 base class 的接口。</p>
<p>成员函数的接口总是会被继承。</p>
<p>pure virtual 函数有两个最突出的特征：他们必须被任何“继承了它们”的具象 class 重新声明，而且它们在抽象 class 中通常没有定义。</p>
<p>声明一个 pure virtual 函数的目的是为了让 derived classes 只继承函数接口。</p>
<p>声明简朴的（非纯）impure virtual 函数的目的，是让 derived classes 继承该函数的接口和缺省实现。</p>
<p>声明 non-virtual 函数的目的是为了令 derived classes 继承函数的接口及一份强制性实现。</p>
<h3 id="35-考虑-virtual-函数以外的其它选择">35. 考虑 virtual 函数以外的其它选择</h3>
<h4 id="藉由-Non-Virtual-手法实现-Template-Method-模式">藉由 Non-Virtual 手法实现 Template Method 模式</h4>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">class GameCharacter &#123;</span><br><span class="line">public:</span><br><span class="line">    int HealthValue() const           &#x2F;&#x2F; derived classes 不重新定义它</span><br><span class="line">    &#123;</span><br><span class="line">        ...</span><br><span class="line">        int value &#x3D; DoHealthValue();</span><br><span class="line">        ...</span><br><span class="line">        return value;</span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br><span class="line">private:    &#x2F;&#x2F; 不是必须 private</span><br><span class="line">    virtual int DoHealthValue() const &#x2F;&#x2F; derived classes 可重新定义它</span><br><span class="line">    &#123;</span><br><span class="line">        ...                           &#x2F;&#x2F; 缺省算法</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>令客户通过 public non-virtual 成员函数间接调用 private virtual 函数，称之为 non-virtual interface（NVI）手法。它是 Template Method 设计模式的一个独特表现形式。non-virtual 函数称为 virtual 函数的外覆器（wrapper）。</p>
<h4 id="藉由-Function-Pointers-手法实现-Strategy-模式">藉由 Function Pointers 手法实现 Strategy 模式</h4>
<p>缺点：将机能从成员函数移到 class 外部函数，导致非成员函数无法访问 class 的 non-public 成员。</p>
<h4 id="藉由-std-function-手法实现-Strategy-模式">藉由 std::function 手法实现 Strategy 模式</h4>
<h4 id="古典的-Strategy-模式">古典的 Strategy 模式</h4>
<p>古典的 Strategy 模式会将健康函数做成一个分离的继承体系中的 virtual 成员函数。</p>
<h3 id="36-绝不重新定义继承而来的-non-virtual-函数">36. 绝不重新定义继承而来的 non-virtual 函数</h3>
<ul>
<li>class 内声明一个 non-virtual 函数会为该 class 建立起一份不变性（invariant），凌驾其特异性（specialization）。</li>
</ul>
<h3 id="37-绝不重新定义继承而来的缺省参数值">37. 绝不重新定义继承而来的缺省参数值</h3>
<ul>
<li>本条款的讨论局限于“继承一个带有缺省参数值的 virtual 函数”，绝对不要新定义继承而来的缺省参数值，因为缺省参数都是静态绑定，而 virtual 函数——你唯一应该复写的东西——却是动态绑定。</li>
</ul>
<h3 id="38-通过复合塑模出-has-a-或“根据某物实现出”">38. 通过复合塑模出 has-a 或“根据某物实现出”</h3>
<ul>
<li>
<p>复合（composition）的意义和 public 继承完全不同。</p>
</li>
<li>
<p>在应用域（application domain），复合意味 has-a（有一个）。在实现域（implementation domain），复合意味 is-implemented-in-terms-of（根据某物实现出）。</p>
</li>
</ul>
<h3 id="39-明智而审慎地使用-private-继承">39. 明智而审慎地使用 private 继承</h3>
<ul>
<li>
<p>Private 继承意味 is-implemented-in-terms-of（根据某物实现出）。它通常比复合（composition）的级别低。但是当 derived class 需要访问 protected base class 的成员，或需要重新定义继承而来的 virtual 函数时，这么设计是合理的。</p>
</li>
<li>
<p>和复合（composition）不同，private 继承可以造成 empty base 最优化。这对致力于“对象尺寸最小化”的程序库开发者而言，可能很重要。</p>
</li>
</ul>
<h3 id="40-明智而审慎地使用多重继承">40. 明智而审慎地使用多重继承</h3>
<ul>
<li>
<p>多重继承比单一继承复杂。它可能导致新的歧义性，以及对 virtual 继承的需要。</p>
</li>
<li>
<p>virtual 继承会增加大小、速度、初始化（及赋值）复杂度等等成本。如果 virtual base classes 不带任何数据，将是最具实用价值的情况。</p>
</li>
<li>
<p>多重继承的确有正当用途。其中一个情节涉及“public 继承某个 Interface class”和“private 继承某个协助实现的 class”的两相组合。</p>
</li>
</ul>
<h2 id="第七章-模板与泛型编程">第七章 模板与泛型编程</h2>
<h3 id="41-了解隐式接口和编译期多态">41. 了解隐式接口和编译期多态</h3>
<ul>
<li>
<p>class 和 template 都支持接口（interface）和多态（polymorphism）。</p>
</li>
<li>
<p>对 class 而言接口是显示（explicit）的，以函数签名为中心。多态则是通过 virtual 函数发生于运行期。</p>
</li>
<li>
<p>对 template 参数而言，接口是隐式的（implicit），奠基于有效表达式。多态则是通过 template 具现化和函数重载解析（function overloading resolution）发生于编译期。</p>
</li>
</ul>
<h3 id="42-了解-typename-的双重意义">42. 了解 typename 的双重意义</h3>
<ul>
<li>
<p>声明 template 参数时，前缀关键字 class 和 typename 可互换。</p>
</li>
<li>
<p>请使用关键字 typename 标识嵌套从属类型名称；但不得在 base class lists（基类列）或 member initialization list（成员初值列）内以它作为 base class 修饰符。</p>
</li>
</ul>
<h3 id="43-学习处理模板化基类内的名称">43. 学习处理模板化基类内的名称</h3>
<ul>
<li>当我们从 Object Oriented C++ 跨进 Template C++，继承就不像以前那么畅行无阻了。面对一些编译不通过的情况，可在 derived class templates 内通过 “this-&gt;” 指涉 base class templates 内的成员名称，或藉由一个明白写出的 “base class 资格修饰符” 完成。</li>
</ul>
<h3 id="44-将与参数无关的代码抽离-templates">44. 将与参数无关的代码抽离 templates</h3>
<ul>
<li>
<p>Templates 生成多个 classes 和多个函数，所以任何 template 代码都不该与某个造成膨胀的 template 参数产生相依关系。</p>
</li>
<li>
<p>因非类型模板参数（non-type template parameters）而造成的代码膨胀，往往可消除，做法是以函数参数或 class 成员变量替换 template 参数。</p>
</li>
<li>
<p>因类型参数（type parameters）而造成的代码膨胀，往往可降低，做法是让带有完全相同二进制表述（binary representations）的具现类型（instantiation types）共享实现码。</p>
</li>
</ul>
<h3 id="45-运用成员函数模板接受所有兼容类型">45. 运用成员函数模板接受所有兼容类型</h3>
<ul>
<li>
<p>请使用成员函数模板（member function templates）生成“可接受所有兼容类型”的函数。</p>
</li>
<li>
<p>如果你声明 member templates 用于“泛化 copy 构造”或“泛化 assignment 操作”，你还是需要声明正常的 copy 构造函数和 copy assignment 操作符。</p>
</li>
</ul>
<h3 id="46-需要类型转换时请为模板定义非成员函数">46. 需要类型转换时请为模板定义非成员函数</h3>
<p>函数的参数可以隐式转换，函数模板不行。</p>
<p>friend 的传统用途是“访问 class 的 non-public 成分”。</p>
<p>在 class 内部声明 non-member 函数的唯一办法就是：令它成为一个 friend。</p>
<ul>
<li>当我们编写一个 class template，而它所提供之“于此 template 相关的”函数支持“所有参数之隐式类型转换”时，请将那些函数定义为“class templdate 内部的 friend 函数”。</li>
</ul>
<h3 id="47-请使用-traits-classes-表现类型信息">47. 请使用 traits classes 表现类型信息</h3>
<p>STL 的迭代器有 5 种：input、output、forward、bidirectional、random access，为了给它们实现统一的 advance 函数，需要再编译期间判断迭代器的类型，这可以使用 Traits 技术来实现。</p>
<ul>
<li>
<p>建立一组重载函数（身份像劳工）或函数模板（例如 doAdvance，最后一个参数是 typename std::iterator_traits<IterT>::iterator_category()），彼此间的差异只在于各自的 traits 参数（可以不命名，只是一个类型）。令每个函数实现码与其接受之 traits 信息相应和。</p>
</li>
<li>
<p>简历一个控制函数（身份像工头）或函数模板（例如 advance），它调用上述那些“劳工函数”并传递 traits class 所提供的信息。</p>
</li>
<li>
<p>Traits classes 使得“类型相关信息”在编译期可用。它们以 templates 和“templates 特化”完成实现。</p>
</li>
<li>
<p>整合重载技术（overloading）后，traits classes 有可能在编译期对类型执行 if…else 测试。</p>
</li>
</ul>
<h3 id="48-认识-template-元编程">48. 认识 template 元编程</h3>
<p>Traits 解法属于 TMP（Template metaprogramming，模板元编程），比 typeid-based 解法高效，高效的原因：</p>
<ul>
<li>
<p>编译期测试类型。</p>
</li>
<li>
<p>类型测试代码不会被链接到可执行程序中。</p>
</li>
</ul>
<p>TMP 是图灵完备（Turling-complete）的。</p>
<ul>
<li>
<p>TMP 可将工作由运行期移往编译期，因而得以实现早期错误侦测和更高的执行效率。</p>
</li>
<li>
<p>TMP 可被用来生成“基于政策选择组合”（based on combinations of policy choices）的客户定制代码，也可用来避免生成对某些特殊类型并不适合的代码。</p>
</li>
</ul>
<h2 id="第八章-定制-new-和-delete">第八章 定制 new 和 delete</h2>
<h3 id="49-了解-new-handler-的行为">49. 了解 new-handler 的行为</h3>
<p>当 operator new 无法满足某一内存分配需求时，它会先调用一个客户指定的错误处理函数 new-handler。（这并非全部事实，参考条款 51）为了指定“用以处理内存不足”的函数，客户必须调用声明于 &lt;new&gt; 的标准库函数 set_new_handler：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="built_in">std</span> &#123;</span><br><span class="line">  <span class="function"><span class="keyword">typedef</span> <span class="title">void</span> <span class="params">(*new_handler)</span><span class="params">()</span></span>;</span><br><span class="line">  <span class="function">new_handler <span class="title">set_new_handler</span><span class="params">(new_handler p)</span> <span class="keyword">noexcept</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>用法示例：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">OutOfMemory</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="built_in">std</span>::<span class="built_in">cerr</span> &lt;&lt; <span class="string">&quot;Unable to satisfy request for memory!\n&quot;</span>;</span><br><span class="line">  <span class="built_in">std</span>::<span class="built_in">abort</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="built_in">std</span>::set_new_handler(OutOfMemory);</span><br><span class="line">  <span class="keyword">char</span>* big_array = <span class="keyword">new</span> <span class="keyword">char</span>[<span class="number">32</span> * <span class="number">1024</span> * <span class="number">1024</span> * <span class="number">1024</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>设计良好的 new-handler 函数必须做一下事情：</p>
<ul>
<li>
<p><strong>让更多内存可被使用</strong>。实现此策略的一个做法是：程序一开始就分配一大块内存，而后当 new-handler 第一次被调用，将它们释还给程序使用。</p>
</li>
<li>
<p><strong>安装另一个 new-handler</strong>。如果当前 new-handler 无法取得更多可用内存，或许它知道另外哪个 new-handler 由此能力。</p>
</li>
<li>
<p><strong>卸除 new-handler</strong>，也就是将 nullptr 传给 set_new_handler，这样 operator new 会在内存分配失败时抛出异常。</p>
</li>
<li>
<p><strong>抛出 bad_alloc 或其派生的异常</strong>。这样的异常不会被 operator new 捕捉，而会被传播到内存索求处。</p>
</li>
<li>
<p><strong>不返回</strong>，通常调用 abort 或 exit。</p>
</li>
</ul>
<p>C++ 不支持 class 专属之 new-handler，如果您需要，可以自己实现，只需每个 class 提供自己的 set_new_handler 和 operator new。</p>
<p>nothrow/noexcept new 是一个颇为局限的工具，因为它只适用于内存分配；后续的构造函数调用还是可能抛出异常。</p>
<h3 id="50-了解-new-和-delete-的合理替换时机">50. 了解 new 和 delete 的合理替换时机</h3>
<p>替换编译器提供的 operator new/delete 的最常见理由：</p>
<ul>
<li>
<p><strong>用来检测运用上的错误。</strong></p>
</li>
<li>
<p><strong>为了强化效能。</strong></p>
<ul>
<li>
<p>增加分配和归还速度。</p>
</li>
<li>
<p>降低缺省内存管理器带来的空间额外开销。</p>
</li>
<li>
<p>弥补缺省分配器种的非最佳齐位（suboptimal alignment）。</p>
</li>
<li>
<p>将相关对象成簇集中。</p>
</li>
</ul>
</li>
<li>
<p><strong>为了收集使用上的统计数据。</strong></p>
</li>
<li>
<p><strong>为了获得非传统的行为。</strong></p>
</li>
</ul>
<h3 id="51-编写-new-和-delete-时需固守常规">51. 编写 new 和 delete 时需固守常规</h3>
<ul>
<li>
<p>operator new 应该内含一个无穷循环，并在其中尝试分配内存，如果它无法满足内存需求，就该调用 new-handler。它也应该有能力处理 0 bytes 申请。Class 专属版本则还应该处理“比正确大小更大的（错误）申请”。</p>
</li>
<li>
<p>operator delelte 应该在收到 null 指针时不做任何事。Class 专属版本处理“比正确大小更大的（错误）申请”。</p>
</li>
</ul>
<h3 id="52-写了-placement-new-也要写-placement-delete">52. 写了 placement new 也要写 placement delete</h3>
<ul>
<li>
<p>当您写一个 <em>placement</em> operator new，请确定也写出了对应的 <em>placement</em> operator delete。否则，您的程序可能会发生隐微而时断时续的内存泄露。</p>
</li>
<li>
<p>当您声明 <em>placement</em> new 和 <em>placement</em> delete，请确定不要无意识（非故意）地遮掩了它们的正常版本。</p>
</li>
</ul>
<h2 id="第九章-杂项讨论">第九章 杂项讨论</h2>
<h3 id="53-不要轻忽编译器的警告">53. 不要轻忽编译器的警告</h3>
<ul>
<li>
<p>严肃对待编译器发出的警告信息。努力在您的编译器的最高（最严苛）警告级别下争取“无任何警告”的荣誉。</p>
</li>
<li>
<p>不要过度依赖编译器的报警能力，因为不同的编译器对待事情的态度并不相同。一旦移植到另一编译器上，您原本依赖的警告信息有可能消失。</p>
</li>
</ul>
<h3 id="54-让自己熟悉-STL">54. 让自己熟悉 STL</h3>
<ul>
<li>
<p>C++ 标准程序库的主要机能由 STL、iostream、locales 组成。并包含 C99 标准程序库。</p>
</li>
<li>
<p>需要熟悉智能指针（例如 std::shared_ptr）、一般化函数指针（std::function）、hash-based 容器、正则表达式（regular expressions）等。</p>
</li>
</ul>
<h3 id="55-让自己熟悉-Boost">55. 让自己熟悉 Boost</h3>
<ul>
<li>
<p>Boost 是一个社群，也是一个网站。致力于免费、开源、同僚复审的 C++ 程序库开发。Boost 在 C++ 标准化过程中扮演深具影响力的角色。</p>
</li>
<li>
<p>Boost 提供数十个类目实现，例如：字符串与文本处理、容器、函数对象和高级编程、泛型编程、模板元编程、数学和数值、正确性与测试、数据结构、语言间的支持、内存、杂项。</p>
</li>
</ul>
<p>（完，最后更新：2020-07-26）</p>
<p>京东联盟购买链接：</p>
<p>推荐购买新版的 <a target="_blank" rel="noopener" href="https://union-click.jd.com/jdc?e=&amp;p=JF8BAMUJK1olXg8CXF1UCEkXCl8LElIQWQcBUFxUCXtTXDdWRGtMGENDFlVDFhNSVzMXQA4KD1heSl1UAU4TAmwMGVIUQl9HCANtfjlFUTttGB93A3hCNztHXUxgRT1vXVcZbQcyVF9fDUkVAGwOK2sVWjZDOltdCUIVM244G1wQXQUFUFdaCkIRBl8PG1IlOXpmU15UOHsnAF84K1slXjZAOg0PWxxEUGoKSVgRXAMHAA4NCR8eBzwPTlITXVFXBAkJOEkWAmsBKw">Effective Modern C++</a> 中国电力出版社 2018年04月01日 平装</p>
<p><img src="/images/effective-modern-cpp.png" alt="Effective Modern C++"> <img src="/images/effective-modern-cpp-jd.png" alt="Effective Modern C++ QR Code"></p>
<p><a target="_blank" rel="noopener" href="https://union-click.jd.com/jdc?e=&amp;p=AyIGZRhfEgoaBVUbXBYyEgZXE1kXAhs3EUQDS10iXhBeGlcJDBkNXg9JHUlSSkkFSRwSBlcTWRcCGxgMXgdIMnt3UkItCxxVZAdtM3FaVF8jUkESYmILWSteFQMTBFIcXRwKIgdUGV4XABEEUytrFQMiUTsbWhQDEwZQG14WMhAGVBlYHQQUB1UrWxIDGgJcG1sSCxYCVStcFQsiYyl%2FXBULIjdVGlkdABAHXCtYJTIiB2UYa1dsEQUHElIVVxICUBtYEAoQAwVIWhAGRVcAGV5AVUEAUk9rFwMTA1w%3D">Effective C++：改善程序与设计的55个具体做法（第3版 中文版）(博文视点出品)</a> 出版时间：2011-01-01 用纸：轻型纸 含试读</p>
<p><a target="_blank" rel="noopener" href="https://union-click.jd.com/jdc?e=&amp;p=AyIGZRprFQMTAFIeXxAyVlgNRQQlW1dCFFlQCxxKQgFHRE5XDVULR0UVAxMAUh5fEB1LQglGa0JlbHETQQRVYktPAU8fa2p3WApZEGUOHjdQG1oUARUAUxJTJQITBVAZWRYBFDdlG1olSXwGZRlaFAARD1MdWxUyEgBUE14cAxUPXRNYFDIVB1wrP2lmFQdcK2sVAxMAUh5fEDIRN2UrWyUBIkU7GFlHCxsHABteEAIRAl0ZX0VREwJRTAtAABdSAkhcElYiBVQaXxw%3D">Effective C++中文版：改善程序与设计的55个具体做法（第3版）</a> 出版时间：2006-07-01</p>

      
    </div>
    <footer class="article-footer">
      
        <a data-url="https://blog.umu618.com/2018/11/26/umutech-effective-cpp/" data-id="cm3zebrdg011hfk7mfg36cv4r" class="article-share-link" data-share="baidu" data-title="《Effective C++》读书笔记">分享到</a>
      

      
        <a href="https://blog.umu618.com/2018/11/26/umutech-effective-cpp/#SOHUCS" class="article-comment-link">评论</a>
      

      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/cpp/" rel="tag">cpp</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-overlooked-bugs" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/11/25/overlooked-bugs/" class="article-date">
  <time datetime="2018-11-25T05:59:53.000Z" itemprop="datePublished">2018-11-25 13:59:53</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E5%AE%87%E7%9D%A3%E8%A7%82/">宇督观</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/11/25/overlooked-bugs/">无人在意的八哥</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="1-主题曲《像屎》">1. 主题曲《像屎》</h2>
<blockquote>
<p>实习生黑锅<br>
是很遥远的事情<br>
八哥算什么<br>
早无人在意<br>
前埔不夜城<br>
处处烤鱼<br>
酒杯中好一片男男风情<br>
最肯忘却故人失<br>
最不屑一顾是相思<br>
养着老怕人笑<br>
还怕人看轻<br>
新又来看乱码呆<br>
竟不见有心人去改<br>
庸才占着茅坑前途不在</p>
</blockquote>
<h2 id="2-百度分享不支持-HTTPS">2. 百度分享不支持 HTTPS</h2>
<p><a target="_blank" rel="noopener" href="http://share.baidu.com/code">百度分享</a>不支持 HTTPS 的解决方案：<a target="_blank" rel="noopener" href="https://github.com/hrwhisper/baiduShare">https://github.com/hrwhisper/baiduShare</a>，最早是 2016-07-09 发布，说明百度分享不支持 HTTPS 已经两年以上。</p>
<h3 id="结论">结论</h3>
<p>百度可能听不进用户的话，用户宁愿自己解决问题……稣也亲自反馈过，应该是被无视了，至今还没官方支持！</p>
<h2 id="3-Linux-内核代码风格翻译错误">3. Linux 内核代码风格翻译错误</h2>
<p><a target="_blank" rel="noopener" href="https://www.kernel.org/doc/html/v4.19/translations/zh_CN/coding-style.html#id12">Linux 内核代码风格 v4.19</a></p>
<blockquote>
<p>分配一个零长数组的首选形式是这样的：<br>
<code>p = kcalloc(n, sizeof(...), ...);</code></p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://www.kernel.org/doc/html/latest/process/coding-style.html#allocating-memory">原文</a>是“The preferred form for allocating a zeroed array is the following:”，所以“零长”应该改为“填零”。</p>
<p><a target="_blank" rel="noopener" href="https://www.kernel.org/doc/htmldocs/kernel-api/API-kcalloc.html">kcalloc 的文档</a>也说：“kcalloc — allocate memory for an array. The memory is set to zero. ”</p>
<p>kcalloc 的定义 <a target="_blank" rel="noopener" href="https://github.com/torvalds/linux/blob/v4.19/include/linux/slab.h">/include/linux/slab.h</a> 更能说明：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;**</span><br><span class="line"> * kcalloc - allocate memory for an array. The memory is set to zero.</span><br><span class="line"> * @n: number of elements.</span><br><span class="line"> * @size: element size.</span><br><span class="line"> * @flags: the type of memory to allocate (see kmalloc).</span><br><span class="line"> *&#x2F;</span><br><span class="line">static inline void *kcalloc(size_t n, size_t size, gfp_t flags)</span><br><span class="line">&#123;</span><br><span class="line">	return kmalloc_array(n, size, flags | __GFP_ZERO);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>“零长数组”应该是指：<code>char u[0];</code></p>
<h3 id="结论-2">结论</h3>
<p>疑智商太高，学习太快，中国的内核开发者都不屑看翻译的文档。</p>

      
    </div>
    <footer class="article-footer">
      
        <a data-url="https://blog.umu618.com/2018/11/25/overlooked-bugs/" data-id="cm3zebrdg011efk7mh3vbcbrp" class="article-share-link" data-share="baidu" data-title="无人在意的八哥">分享到</a>
      

      
        <a href="https://blog.umu618.com/2018/11/25/overlooked-bugs/#SOHUCS" class="article-comment-link">评论</a>
      

      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/debug/" rel="tag">debug</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-umutech-mongodb-metrics-from-db-stats" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/11/18/umutech-mongodb-metrics-from-db-stats/" class="article-date">
  <time datetime="2018-11-18T11:16:25.000Z" itemprop="datePublished">2018-11-18 19:16:25</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/UMUTech/">UMUTech</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/11/18/umutech-mongodb-metrics-from-db-stats/">MongoDB db.stats() 的各种 Size</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="现象">现象</h2>
<p>db.stats() 的各种 Size 需要理理，先看例子：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&gt; db.action_traces.dataSize()</span><br><span class="line">12489840963</span><br><span class="line"></span><br><span class="line">&gt; db.action_traces.totalSize()</span><br><span class="line">5391249408</span><br><span class="line"></span><br><span class="line">&gt; db.action_traces.storageSize()</span><br><span class="line">3684032512</span><br><span class="line"></span><br><span class="line">&gt; db.action_traces.totalIndexSize()</span><br><span class="line">1707216896</span><br></pre></td></tr></table></figure>
<h2 id="概念解释">概念解释</h2>
<p>db.action_traces.stats() 里的 size 就是 db.action_traces.dataSize()，也就是数据本身的逻辑大小。</p>
<p>由于数据库引擎有压缩概念，所以存储到介质时，可能占用的空间并没有逻辑大小那么多，比如 WiredTiger Storage Engine 的压缩率就挺不错的，dataSize = 12,489,840,963 字节的数据，存到硬盘只有 storageSize = 5,391,249,408 字节。</p>
<p>其中 totalIndexSize 是索引占存储器的大小，所以 totalSize = storageSize + totalIndexSize。</p>
<p>注意：索引有时会比数据本身还大……</p>
<h2 id="参考">参考</h2>
<p><a target="_blank" rel="noopener" href="https://docs.mongodb.com/manual/reference/method/db.collection.stats/index.html">db.collection.stats() — MongoDB Manual</a></p>
<p><a target="_blank" rel="noopener" href="https://docs.mongodb.com/manual/reference/method/db.collection.totalIndexSize/index.html">db.collection.totalIndexSize() — MongoDB Manual</a></p>
<p><a target="_blank" rel="noopener" href="https://docs.mongodb.com/manual/reference/method/db.collection.dataSize/index.html">db.collection.dataSize() — MongoDB Manual</a></p>
<p><a target="_blank" rel="noopener" href="https://docs.mongodb.com/manual/reference/method/db.collection.storageSize/index.html">db.collection.storageSize() — MongoDB Manual</a></p>
<p><a target="_blank" rel="noopener" href="https://docs.mongodb.com/manual/reference/method/db.collection.totalSize/">db.collection.totalSize() — MongoDB Manual</a></p>

      
    </div>
    <footer class="article-footer">
      
        <a data-url="https://blog.umu618.com/2018/11/18/umutech-mongodb-metrics-from-db-stats/" data-id="cm3zebrdf0118fk7mbmsv6pxz" class="article-share-link" data-share="baidu" data-title="MongoDB db.stats() 的各种 Size">分享到</a>
      

      
        <a href="https://blog.umu618.com/2018/11/18/umutech-mongodb-metrics-from-db-stats/#SOHUCS" class="article-comment-link">评论</a>
      

      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/mongodb/" rel="tag">mongodb</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ops/" rel="tag">ops</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-umutech-screenshot-hotkey" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/11/18/umutech-screenshot-hotkey/" class="article-date">
  <time datetime="2018-11-18T08:39:22.000Z" itemprop="datePublished">2018-11-18 16:39:22</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/UMUTech/">UMUTech</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/11/18/umutech-screenshot-hotkey/">截屏热键怎么设置才能截菜单？</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>稣习惯使用 Ctrl+Shift+A 或 Ctrl+F12 作为截屏热键，而微信 PC 版的默认截屏热键是 Alt+A。</p>
<p>今天被人问“怎么截菜单？”稣一脸懵逼，回答：“和截其它，有什么不同吗？”对方说：“一按截屏热键菜单就退出了！”</p>
<p>稣恍然大悟，原来 TA 没改默认热键，只要按下 Alt，菜单确实会退出……</p>
<p>默认的不一定最好。PS：TX 程序员不懂这个道理吗？为什么选择 Alt+A 这样奇葩的组合！</p>

      
    </div>
    <footer class="article-footer">
      
        <a data-url="https://blog.umu618.com/2018/11/18/umutech-screenshot-hotkey/" data-id="cm3zebrdf011bfk7mamxidqvh" class="article-share-link" data-share="baidu" data-title="截屏热键怎么设置才能截菜单？">分享到</a>
      

      
        <a href="https://blog.umu618.com/2018/11/18/umutech-screenshot-hotkey/#SOHUCS" class="article-comment-link">评论</a>
      

      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/debug/" rel="tag">debug</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/windows/" rel="tag">windows</a></li></ul>

    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    <a class="extend prev" rel="prev" href="/page/30/">&laquo; 上一页</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/29/">29</a><a class="page-number" href="/page/30/">30</a><span class="page-number current">31</span><a class="page-number" href="/page/32/">32</a><a class="page-number" href="/page/33/">33</a><span class="space">&hellip;</span><a class="page-number" href="/page/70/">70</a><a class="extend next" rel="next" href="/page/32/">下一页 &raquo;</a>
  </nav>
</section>
      
      <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">分类</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/UMUTech/">UMUTech</a><span class="category-list-count">203</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/U%E5%A2%A8/">U墨</a><span class="category-list-count">18</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%90%93%E9%86%92/">吓醒</a><span class="category-list-count">87</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%AE%87%E7%9D%A3%E8%A7%82/">宇督观</a><span class="category-list-count">53</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E8%AF%97%E7%9B%97/">诗盗</a><span class="category-list-count">330</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/archlinux/" rel="tag">archlinux</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/armbian/" rel="tag">armbian</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/atl/" rel="tag">atl</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/blockchain/" rel="tag">blockchain</a><span class="tag-list-count">17</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/boost/" rel="tag">boost</a><span class="tag-list-count">11</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/c/" rel="tag">c</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ceph/" rel="tag">ceph</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/coding-style/" rel="tag">coding-style</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cpp/" rel="tag">cpp</a><span class="tag-list-count">41</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cppwinrt/" rel="tag">cppwinrt</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cryptology/" rel="tag">cryptology</a><span class="tag-list-count">7</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/debian/" rel="tag">debian</a><span class="tag-list-count">12</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/debug/" rel="tag">debug</a><span class="tag-list-count">51</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/dev/" rel="tag">dev</a><span class="tag-list-count">86</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/directx/" rel="tag">directx</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/dotnet/" rel="tag">dotnet</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/embedded/" rel="tag">embedded</a><span class="tag-list-count">42</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ffmpeg/" rel="tag">ffmpeg</a><span class="tag-list-count">8</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/go/" rel="tag">go</a><span class="tag-list-count">9</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/gsl/" rel="tag">gsl</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/lib/" rel="tag">lib</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/" rel="tag">linux</a><span class="tag-list-count">58</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/machine-learning/" rel="tag">machine-learning</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/macos/" rel="tag">macos</a><span class="tag-list-count">10</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mongodb/" rel="tag">mongodb</a><span class="tag-list-count">9</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nodejs/" rel="tag">nodejs</a><span class="tag-list-count">8</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/openwrt/" rel="tag">openwrt</a><span class="tag-list-count">32</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ops/" rel="tag">ops</a><span class="tag-list-count">40</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/optimization/" rel="tag">optimization</a><span class="tag-list-count">18</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/powershell/" rel="tag">powershell</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/" rel="tag">python</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/raspbian/" rel="tag">raspbian</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/reverse-engineering/" rel="tag">reverse-engineering</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/router/" rel="tag">router</a><span class="tag-list-count">7</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/rust/" rel="tag">rust</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/security/" rel="tag">security</a><span class="tag-list-count">12</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/streaming-media/" rel="tag">streaming-media</a><span class="tag-list-count">10</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/windows/" rel="tag">windows</a><span class="tag-list-count">48</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%B8%83%E5%BE%8B/" rel="tag">七律</a><span class="tag-list-count">168</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%B8%83%E9%B9%B0%E5%9C%A3/" rel="tag">七鹰圣</a><span class="tag-list-count">8</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%BA%94%E8%A8%80/" rel="tag">五言</a><span class="tag-list-count">81</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%BD%9C%E5%93%81/" rel="tag">作品</a><span class="tag-list-count">8</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%81%9A%E9%A2%98/" rel="tag">做题</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%96%B7/" rel="tag">喷</a><span class="tag-list-count">132</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%9C%A3%E5%B0%8F%E5%BC%80/" rel="tag">圣小开</a><span class="tag-list-count">10</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%AF%93%E8%A8%80/" rel="tag">寓言</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%AF%B9%E8%81%94/" rel="tag">对联</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%BD%B1%E8%AF%84/" rel="tag">影评</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%BF%83%E7%90%86%E9%82%AA%E7%A8%A3/" rel="tag">心理邪稣</a><span class="tag-list-count">45</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%80%AA%E6%82%9F/" rel="tag">怪悟</a><span class="tag-list-count">25</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%89%93%E5%98%B4%E7%82%AE/" rel="tag">打嘴炮</a><span class="tag-list-count">47</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%8C%A8%E8%B8%A2/" rel="tag">挨踢</a><span class="tag-list-count">118</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%B0%E5%AD%A6/" rel="tag">数学</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9A%B4%E8%B5%B0/" rel="tag">暴走</a><span class="tag-list-count">8</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%AD%8C%E8%AF%84/" rel="tag">歌评</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%AD%BB%E7%A5%9E/" rel="tag">死神</a><span class="tag-list-count">12</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%B3%A5%E5%B7%B4%E5%A8%83/" rel="tag">泥巴娃</a><span class="tag-list-count">15</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%B4%97%E8%84%91/" rel="tag">洗脑</a><span class="tag-list-count">14</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%80%B6%E4%B9%8E%E7%9F%A5%E7%A8%A3/" rel="tag">耶乎知稣</a><span class="tag-list-count">15</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%AF%8D/" rel="tag">词</a><span class="tag-list-count">81</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%B0%83%E7%A0%94/" rel="tag">调研</a><span class="tag-list-count">20</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%87%8F%E5%AD%90%E9%82%AA%E7%A8%A3/" rel="tag">量子邪稣</a><span class="tag-list-count">13</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%87%91%E8%9E%8D/" rel="tag">金融</a><span class="tag-list-count">32</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%97%BD%E5%8D%97%E8%AF%AD/" rel="tag">闽南语</a><span class="tag-list-count">16</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%9C%B9%E9%9B%B3/" rel="tag">霹雳</a><span class="tag-list-count">65</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%B2%B8%E7%A5%9E%E9%93%BE/" rel="tag">鲸神链</a><span class="tag-list-count">44</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%B2%B8%E7%A5%9E%E9%AD%82%E8%A3%82/" rel="tag">鲸神魂裂</a><span class="tag-list-count">48</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%B9%8F%E9%A3%8E/" rel="tag">鹏风</a><span class="tag-list-count">27</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/tags/archlinux/" style="font-size: 10px;">archlinux</a> <a href="/tags/armbian/" style="font-size: 10.86px;">armbian</a> <a href="/tags/atl/" style="font-size: 10px;">atl</a> <a href="/tags/blockchain/" style="font-size: 14.29px;">blockchain</a> <a href="/tags/boost/" style="font-size: 12.57px;">boost</a> <a href="/tags/c/" style="font-size: 10.57px;">c</a> <a href="/tags/ceph/" style="font-size: 10px;">ceph</a> <a href="/tags/coding-style/" style="font-size: 11.14px;">coding-style</a> <a href="/tags/cpp/" style="font-size: 16.29px;">cpp</a> <a href="/tags/cppwinrt/" style="font-size: 10px;">cppwinrt</a> <a href="/tags/cryptology/" style="font-size: 11.43px;">cryptology</a> <a href="/tags/debian/" style="font-size: 12.86px;">debian</a> <a href="/tags/debug/" style="font-size: 18px;">debug</a> <a href="/tags/dev/" style="font-size: 19.14px;">dev</a> <a href="/tags/directx/" style="font-size: 10px;">directx</a> <a href="/tags/dotnet/" style="font-size: 10.29px;">dotnet</a> <a href="/tags/embedded/" style="font-size: 16.57px;">embedded</a> <a href="/tags/ffmpeg/" style="font-size: 11.71px;">ffmpeg</a> <a href="/tags/go/" style="font-size: 12px;">go</a> <a href="/tags/gsl/" style="font-size: 10.86px;">gsl</a> <a href="/tags/lib/" style="font-size: 10px;">lib</a> <a href="/tags/linux/" style="font-size: 18.29px;">linux</a> <a href="/tags/machine-learning/" style="font-size: 10.57px;">machine-learning</a> <a href="/tags/macos/" style="font-size: 12.29px;">macos</a> <a href="/tags/mongodb/" style="font-size: 12px;">mongodb</a> <a href="/tags/nodejs/" style="font-size: 11.71px;">nodejs</a> <a href="/tags/openwrt/" style="font-size: 15.71px;">openwrt</a> <a href="/tags/ops/" style="font-size: 16px;">ops</a> <a href="/tags/optimization/" style="font-size: 14.57px;">optimization</a> <a href="/tags/powershell/" style="font-size: 10.29px;">powershell</a> <a href="/tags/python/" style="font-size: 10px;">python</a> <a href="/tags/raspbian/" style="font-size: 10px;">raspbian</a> <a href="/tags/reverse-engineering/" style="font-size: 10.57px;">reverse-engineering</a> <a href="/tags/router/" style="font-size: 11.43px;">router</a> <a href="/tags/rust/" style="font-size: 10.86px;">rust</a> <a href="/tags/security/" style="font-size: 12.86px;">security</a> <a href="/tags/streaming-media/" style="font-size: 12.29px;">streaming-media</a> <a href="/tags/windows/" style="font-size: 17.71px;">windows</a> <a href="/tags/%E4%B8%83%E5%BE%8B/" style="font-size: 20px;">七律</a> <a href="/tags/%E4%B8%83%E9%B9%B0%E5%9C%A3/" style="font-size: 11.71px;">七鹰圣</a> <a href="/tags/%E4%BA%94%E8%A8%80/" style="font-size: 18.86px;">五言</a> <a href="/tags/%E4%BD%9C%E5%93%81/" style="font-size: 11.71px;">作品</a> <a href="/tags/%E5%81%9A%E9%A2%98/" style="font-size: 10.57px;">做题</a> <a href="/tags/%E5%96%B7/" style="font-size: 19.71px;">喷</a> <a href="/tags/%E5%9C%A3%E5%B0%8F%E5%BC%80/" style="font-size: 12.29px;">圣小开</a> <a href="/tags/%E5%AF%93%E8%A8%80/" style="font-size: 10px;">寓言</a> <a href="/tags/%E5%AF%B9%E8%81%94/" style="font-size: 11.14px;">对联</a> <a href="/tags/%E5%BD%B1%E8%AF%84/" style="font-size: 10.29px;">影评</a> <a href="/tags/%E5%BF%83%E7%90%86%E9%82%AA%E7%A8%A3/" style="font-size: 17.14px;">心理邪稣</a> <a href="/tags/%E6%80%AA%E6%82%9F/" style="font-size: 15.14px;">怪悟</a> <a href="/tags/%E6%89%93%E5%98%B4%E7%82%AE/" style="font-size: 17.43px;">打嘴炮</a> <a href="/tags/%E6%8C%A8%E8%B8%A2/" style="font-size: 19.43px;">挨踢</a> <a href="/tags/%E6%95%B0%E5%AD%A6/" style="font-size: 10.86px;">数学</a> <a href="/tags/%E6%9A%B4%E8%B5%B0/" style="font-size: 11.71px;">暴走</a> <a href="/tags/%E6%AD%8C%E8%AF%84/" style="font-size: 10px;">歌评</a> <a href="/tags/%E6%AD%BB%E7%A5%9E/" style="font-size: 12.86px;">死神</a> <a href="/tags/%E6%B3%A5%E5%B7%B4%E5%A8%83/" style="font-size: 13.71px;">泥巴娃</a> <a href="/tags/%E6%B4%97%E8%84%91/" style="font-size: 13.43px;">洗脑</a> <a href="/tags/%E8%80%B6%E4%B9%8E%E7%9F%A5%E7%A8%A3/" style="font-size: 13.71px;">耶乎知稣</a> <a href="/tags/%E8%AF%8D/" style="font-size: 18.86px;">词</a> <a href="/tags/%E8%B0%83%E7%A0%94/" style="font-size: 14.86px;">调研</a> <a href="/tags/%E9%87%8F%E5%AD%90%E9%82%AA%E7%A8%A3/" style="font-size: 13.14px;">量子邪稣</a> <a href="/tags/%E9%87%91%E8%9E%8D/" style="font-size: 15.71px;">金融</a> <a href="/tags/%E9%97%BD%E5%8D%97%E8%AF%AD/" style="font-size: 14px;">闽南语</a> <a href="/tags/%E9%9C%B9%E9%9B%B3/" style="font-size: 18.57px;">霹雳</a> <a href="/tags/%E9%B2%B8%E7%A5%9E%E9%93%BE/" style="font-size: 16.86px;">鲸神链</a> <a href="/tags/%E9%B2%B8%E7%A5%9E%E9%AD%82%E8%A3%82/" style="font-size: 17.71px;">鲸神魂裂</a> <a href="/tags/%E9%B9%8F%E9%A3%8E/" style="font-size: 15.43px;">鹏风</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/10/">十月 2024</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/09/">九月 2024</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/08/">八月 2024</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/07/">七月 2024</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/06/">六月 2024</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/05/">五月 2024</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/04/">四月 2024</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/03/">三月 2024</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/02/">二月 2024</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/01/">一月 2024</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/12/">十二月 2023</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/11/">十一月 2023</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/10/">十月 2023</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/09/">九月 2023</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/08/">八月 2023</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/07/">七月 2023</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/06/">六月 2023</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/05/">五月 2023</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/04/">四月 2023</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/03/">三月 2023</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/02/">二月 2023</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/01/">一月 2023</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/12/">十二月 2022</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/10/">十月 2022</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/09/">九月 2022</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/08/">八月 2022</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/07/">七月 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/06/">六月 2022</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/05/">五月 2022</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/04/">四月 2022</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/03/">三月 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/01/">一月 2022</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/12/">十二月 2021</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/11/">十一月 2021</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/09/">九月 2021</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/08/">八月 2021</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/07/">七月 2021</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/06/">六月 2021</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/05/">五月 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/03/">三月 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/02/">二月 2021</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">一月 2021</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/12/">十二月 2020</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">十月 2020</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/09/">九月 2020</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">八月 2020</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">七月 2020</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/06/">六月 2020</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/05/">五月 2020</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/04/">四月 2020</a><span class="archive-list-count">11</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">三月 2020</a><span class="archive-list-count">10</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/02/">二月 2020</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">一月 2020</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">十二月 2019</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">十一月 2019</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">十月 2019</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/09/">九月 2019</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">八月 2019</a><span class="archive-list-count">10</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">七月 2019</a><span class="archive-list-count">12</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/06/">六月 2019</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">五月 2019</a><span class="archive-list-count">18</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">四月 2019</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">三月 2019</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/02/">二月 2019</a><span class="archive-list-count">18</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">一月 2019</a><span class="archive-list-count">19</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">十二月 2018</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">十一月 2018</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">十月 2018</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">九月 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">八月 2018</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">七月 2018</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">六月 2018</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">五月 2018</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">四月 2018</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/03/">三月 2018</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/02/">二月 2018</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">一月 2018</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">十二月 2017</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">十一月 2017</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">十月 2017</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">九月 2017</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">八月 2017</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">七月 2017</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/">四月 2017</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">三月 2017</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/02/">二月 2017</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/01/">一月 2017</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/12/">十二月 2016</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/11/">十一月 2016</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/10/">十月 2016</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/09/">九月 2016</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/08/">八月 2016</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/07/">七月 2016</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/06/">六月 2016</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/05/">五月 2016</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/04/">四月 2016</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/03/">三月 2016</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/02/">二月 2016</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/01/">一月 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/12/">十二月 2015</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/11/">十一月 2015</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/10/">十月 2015</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/09/">九月 2015</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/08/">八月 2015</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/07/">七月 2015</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/06/">六月 2015</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/05/">五月 2015</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/04/">四月 2015</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/03/">三月 2015</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/02/">二月 2015</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/01/">一月 2015</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/12/">十二月 2014</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/10/">十月 2014</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/09/">九月 2014</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/08/">八月 2014</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/07/">七月 2014</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/06/">六月 2014</a><span class="archive-list-count">12</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/05/">五月 2014</a><span class="archive-list-count">10</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/04/">四月 2014</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/03/">三月 2014</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/02/">二月 2014</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/01/">一月 2014</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/12/">十二月 2013</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/11/">十一月 2013</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/10/">十月 2013</a><span class="archive-list-count">14</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/09/">九月 2013</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/08/">八月 2013</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/07/">七月 2013</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/06/">六月 2013</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/05/">五月 2013</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/04/">四月 2013</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/03/">三月 2013</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/02/">二月 2013</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/01/">一月 2013</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/12/">十二月 2012</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/11/">十一月 2012</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/10/">十月 2012</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/09/">九月 2012</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/08/">八月 2012</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/07/">七月 2012</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/06/">六月 2012</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/05/">五月 2012</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/04/">四月 2012</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/02/">二月 2012</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/01/">一月 2012</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/12/">十二月 2011</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/11/">十一月 2011</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/09/">九月 2011</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/07/">七月 2011</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/04/">四月 2011</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/03/">三月 2011</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/02/">二月 2011</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/01/">一月 2011</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/11/">十一月 2010</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/07/">七月 2010</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/06/">六月 2010</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/03/">三月 2010</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/02/">二月 2010</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/01/">一月 2010</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2009/12/">十二月 2009</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2009/11/">十一月 2009</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2009/10/">十月 2009</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2009/09/">九月 2009</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2009/08/">八月 2009</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2009/06/">六月 2009</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2009/05/">五月 2009</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2009/04/">四月 2009</a><span class="archive-list-count">18</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2009/03/">三月 2009</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2009/02/">二月 2009</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2009/01/">一月 2009</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2008/12/">十二月 2008</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2008/09/">九月 2008</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2008/08/">八月 2008</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2008/07/">七月 2008</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2008/06/">六月 2008</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2008/05/">五月 2008</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2008/04/">四月 2008</a><span class="archive-list-count">1</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">近期文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2024/10/11/umutech-compile-ffmpeg/">Windows 平台编译 FFmpeg</a>
          </li>
        
          <li>
            <a href="/2024/09/21/umutech-protect-your-private-keys-on-windows/">Windows 平台用 VBS 保护私钥安全</a>
          </li>
        
          <li>
            <a href="/2024/08/20/umutech-dh/">Diffie-Hellman 密钥交换协议</a>
          </li>
        
          <li>
            <a href="/2024/08/10/programmers-are-smart/">真实的程序员情商高得可怕！</a>
          </li>
        
          <li>
            <a href="/2024/08/04/umutech-should-i-use-std-string-view-instead-of-passing-std-string-by-const-reference/">该不该用 std::string_view 替代 const std::string&amp;？</a>
          </li>
        
      </ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">友情链接</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="http://my.oschina.net/umu618" target="_blank">UMUTech</a>
          </li>
        
          <li>
            <a href="http://blog.vichamp.com/" target="_blank">叹为观止</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
      
    </div>
    <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
	  <a href="https://beian.miit.gov.cn/" target="_blank">闽ICP备14015033号-1</a>
	  &copy; 2008-2024 圣小开<br>
      Powered by <a href="//hexo.io/" target="_blank">Hexo</a>
      Theme by <a href="https://github.com/xiangming/landscape-plus" target="_blank">Landscape-plus</a>
    </div>
  </div>
</footer>
  </div>
  <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">首页</a>
  
    <a href="/archives" class="mobile-nav-link">归档</a>
  
    <a href="/about" class="mobile-nav-link">关于</a>
  
</nav>
  <!-- totop start -->
<div id="totop">
<a title="返回顶部"><img src="/img/scrollup.png"/></a>
</div>

<!-- totop end -->

<script type="text/javascript"> 
  (function(){ 
  var appid = 'cytnUIVvU'; 
  var conf = 'prod_ec4a41b6dd2a5922bc15dea6d7b0cab4'; 
  var width = window.innerWidth || document.documentElement.clientWidth; 
  if (width < 960) {
  var head = document.getElementsByTagName('head')[0]||document.head||document.documentElement;
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.charset = 'utf-8';
  script.id = 'changyan_mobile_js';
  script.src = 'https://cy-cdn.kuaizhan.com/upload/mobile/wap-js/changyan_mobile.js?client_id=' + appid + '&conf=' + conf;
  head.appendChild(script);
  } else { var loadJs=function(d,a){var c=document.getElementsByTagName("head")[0]||document.head||document.documentElement;var b=document.createElement("script");b.setAttribute("type","text/javascript");b.setAttribute("charset","UTF-8");b.setAttribute("src",d);if(typeof a==="function"){if(window.attachEvent){b.onreadystatechange=function(){var e=b.readyState;if(e==="loaded"||e==="complete"){b.onreadystatechange=null;a()}}}else{b.onload=a}}c.appendChild(b)};loadJs("https://cy-cdn.kuaizhan.com/upload/changyan.js",function(){window.changyan.api.config({appid:appid,conf:conf})}); } })();
</script>


<!-- 百度分享 start -->

<div id="article-share-box" class="article-share-box">
  <div id="bdshare" class="bdsharebuttonbox article-share-links">
    <a class="article-share-weibo" data-cmd="tsina" title="分享到新浪微博"></a>
    <a class="article-share-weixin" data-cmd="weixin" title="分享到微信"></a>
    <a class="article-share-qq" data-cmd="sqq" title="分享到QQ"></a>
    <a class="article-share-renren" data-cmd="renren" title="分享到人人网"></a>
    <a class="article-share-more" data-cmd="more" title="更多"></a>
  </div>
</div>
<script>
  function SetShareData(cmd, config) {
    if (shareDataTitle && shareDataUrl) {
      config.bdText = shareDataTitle;
      config.bdUrl = shareDataUrl;
    }
    return config;
  }
  window._bd_share_config={
    "common":{onBeforeClick: SetShareData},
    "share":{"bdCustomStyle":"/css/bdshare.css"}
  };
  with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?cdnversion='+~(-new Date()/36e5)];
</script>

<!-- 百度分享 end -->

<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>





<script src="/js/script.js"></script>


</div>
</body>
</html>
